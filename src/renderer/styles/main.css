    /* Removed broken Google Fonts import - using system fonts */


    /* ========== PRO-MAX DESIGN SYSTEM ========== */
    :root {
      /* Spacing Scale */
      --space-xs: 4px;
      --space-sm: 8px;
      --space-md: 12px;
      --space-lg: 16px;
      --space-xl: 24px;
      --space-2xl: 32px;
      --space-3xl: 48px;

      /* Animation Timing */
      --transition-fast: 150ms ease;
      --transition-base: 200ms ease;
      --transition-slow: 300ms ease;
      --transition-spring: 300ms cubic-bezier(0.34, 1.56, 0.64, 1);

      /* Backgrounds - Midnight Aurora */
      --bg: #07090c;
      --bg-gradient: radial-gradient(circle at 50% 0%, #111827 0%, #07090c 100%);
      --bg-elevated: rgba(17, 24, 39, 0.7);

      /* Glassmorphism */
      --glass-bg: rgba(255, 255, 255, 0.03);
      --glass-border: rgba(255, 255, 255, 0.08);
      --glass-blur: blur(12px);

      /* Cards */
      --card: rgba(23, 31, 46, 0.6);
      --card-elevated: rgba(30, 41, 59, 0.8);
      --card-hover: rgba(30, 41, 59, 1);
      --card-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.4);

      /* Text - Arctic White & Slate */
      --text: #f1f5f9;
      --text-primary: #ffffff;
      --text-secondary: #94a3b8;
      --text-tertiary: #64748b;
      --text-muted: #475569;

      /* Accents - Midnight & Aurora */
      --accent: #10b981;
      /* Emerald Green */
      --accent-secondary: #3b82f6;
      /* Azure Blue (Aurora) */
      --accent-deep: #1e40af;
      /* Deep Midnight Blue */
      --accent-hover: #34d399;
      /* Lighter Emerald */
      --accent-pressed: #059669;
      /* Darker Emerald */
      --slate: #64748b;
      /* Slate */
      --selection: rgba(16, 185, 129, 0.2);

      /* Functional */
      --danger: #f43f5e;
      --success: #10b981;
      --warning: #f59e0b;
      --info: #3b82f6;

      /* Borders */
      --line: rgba(255, 255, 255, 0.1);
      --line-strong: rgba(255, 255, 255, 0.2);
      --line-focus: rgba(245, 158, 11, 0.4);

      /* Utility */
      --bg-darker: rgba(0, 0, 0, 0.3);
      --overlay: rgba(0, 0, 0, 0.6);
      --overlay-light: rgba(0, 0, 0, 0.4);
      --fg: #f1f5f9;
      --line-subtle: rgba(255, 255, 255, 0.05);

      /* Legacy compatibility */
      --muted: #94a3b8;
    }

    [data-theme="light"] {
      --bg: #f8fafc;
      --bg-gradient: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
      --bg-elevated: rgba(255, 255, 255, 0.8);

      --glass-bg: rgba(255, 255, 255, 0.4);
      --glass-border: rgba(0, 0, 0, 0.1);
      --glass-blur: blur(10px);

      --card: #ffffff;
      --card-elevated: #ffffff;
      --card-hover: #f1f5f9;
      --card-shadow: 0 4px 12px 0 rgba(0, 0, 0, 0.05);

      --text: #1e293b;
      --text-primary: #0f172a;
      --text-secondary: #475569;
      --text-tertiary: #64748b;
      --text-muted: #94a3b8;

      --accent: #059669;
      --accent-hover: #047857;
      --accent-pressed: #065f46;

      --line: rgba(0, 0, 0, 0.08);
      --line-strong: rgba(0, 0, 0, 0.15);
      --line-focus: rgba(217, 119, 6, 0.4);
      --line-subtle: rgba(0, 0, 0, 0.03);

      --overlay: rgba(0, 0, 0, 0.4);
      --overlay-light: rgba(0, 0, 0, 0.2);
      --fg: #1e293b;

      --muted: #64748b;
    }

    /* ============================================
       LUCIDE ICON SYSTEM
       ============================================ */
    .lucide-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      vertical-align: middle;
    }

    .lucide-icon svg {
      width: 100%;
      height: 100%;
      stroke: currentColor;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
      fill: none;
    }

    .lucide-icon.icon-filled svg {
      fill: currentColor;
    }

    .icon-xs {
      width: 14px;
      height: 14px;
    }

    .icon-sm {
      width: 16px;
      height: 16px;
    }

    .icon-md {
      width: 20px;
      height: 20px;
    }

    .icon-lg {
      width: 24px;
      height: 24px;
    }

    .icon-xl {
      width: 32px;
      height: 32px;
    }

    /* ============================================
       SPACING UTILITIES
       ============================================ */
    .gap-xs {
      gap: var(--space-xs);
    }

    .gap-sm {
      gap: var(--space-sm);
    }

    .gap-md {
      gap: var(--space-md);
    }

    .gap-lg {
      gap: var(--space-lg);
    }

    .gap-xl {
      gap: var(--space-xl);
    }

    .p-xs {
      padding: var(--space-xs);
    }

    .p-sm {
      padding: var(--space-sm);
    }

    .p-md {
      padding: var(--space-md);
    }

    .p-lg {
      padding: var(--space-lg);
    }

    .p-xl {
      padding: var(--space-xl);
    }

    .px-sm {
      padding-left: var(--space-sm);
      padding-right: var(--space-sm);
    }

    .px-md {
      padding-left: var(--space-md);
      padding-right: var(--space-md);
    }

    .px-lg {
      padding-left: var(--space-lg);
      padding-right: var(--space-lg);
    }

    .py-sm {
      padding-top: var(--space-sm);
      padding-bottom: var(--space-sm);
    }

    .py-md {
      padding-top: var(--space-md);
      padding-bottom: var(--space-md);
    }

    .py-lg {
      padding-top: var(--space-lg);
      padding-bottom: var(--space-lg);
    }

    .m-0 {
      margin: 0;
    }

    .mb-xs {
      margin-bottom: var(--space-xs);
    }

    .mb-sm {
      margin-bottom: var(--space-sm);
    }

    .mb-md {
      margin-bottom: var(--space-md);
    }

    .mb-lg {
      margin-bottom: var(--space-lg);
    }

    .mb-xl {
      margin-bottom: var(--space-xl);
    }

    .mt-sm {
      margin-top: var(--space-sm);
    }

    .mt-md {
      margin-top: var(--space-md);
    }

    .mt-lg {
      margin-top: var(--space-lg);
    }

    /* ============================================
       GLOBAL STYLES & RESETS
       ============================================ */

    /* Make date picker calendar icon visible */
    input[type="date"]::-webkit-calendar-picker-indicator {
      filter: invert(1);
      cursor: pointer;
    }

    /* Prevent transitions on page load */
    body.no-transitions,
    body.no-transitions * {
      transition: none !important;
    }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
      background: var(--bg);
      background-image: var(--bg-gradient);
      background-attachment: fixed;
      color: var(--text);
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
    }

    /* Skeleton Loader */
    .skeleton {
      background: linear-gradient(90deg,
          rgba(255, 255, 255, 0.05) 25%,
          rgba(255, 255, 255, 0.1) 50%,
          rgba(255, 255, 255, 0.05) 75%);
      background-size: 200% 100%;
      animation: skeleton-loading 1.5s infinite;
      border-radius: 12px;
    }

    @keyframes skeleton-loading {
      0% {
        background-position: 200% 0;
      }

      100% {
        background-position: -200% 0;
      }
    }

    header {
      padding: 16px 24px;
      border-bottom: 1px solid var(--glass-border);
      position: sticky;
      top: 0;
      background: var(--bg-elevated);
      -webkit-backdrop-filter: var(--glass-blur);
      backdrop-filter: var(--glass-blur);
      z-index: 100;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
      overflow: visible;
    }

    h1 {
      font-size: 20px;
      font-weight: 700;
      letter-spacing: -0.02em;
      margin: 0;
      color: var(--text-primary);
    }

    .muted {
      color: var(--text-tertiary);
      font-size: 12px;
    }

    .wrap {
      padding: 14px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .tabs {
      display: flex;
      gap: 4px;
      flex-wrap: nowrap;
      margin-top: 0;
      overflow: hidden;
      flex: 1;
      min-width: 0;
    }

    .tabs .tab {
      appearance: none;
      font-family: inherit;
    }

    .tab {
      padding: 6px 8px;
      border-radius: 8px;
      border: 1px solid var(--glass-border);
      background: var(--glass-bg);
      cursor: pointer;
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
      transition: all var(--transition-base);
      white-space: nowrap;
      flex-shrink: 0;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      position: relative;
    }

    .tab:hover {
      background: rgba(255, 255, 255, 0.08);
      color: var(--text-primary);
      transform: translateY(-1px);
    }

    .tab:active {
      transform: translateY(0) scale(0.98);
    }

    .tab.active {
      background: var(--accent);
      border-color: var(--accent);
      color: #000;
      font-weight: 600;
      box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
    }

    .grid {
      display: block;
      /* Was grid - changed to block to fix zero-height issue */
      padding: 24px;
      height: auto !important;
      max-width: 1400px;
      margin: 0 auto;
    }

    /* TAB VISIBILITY SYSTEM - DEFINITIVE FIX */
    section[id^="tab-"] {
      display: none !important;
      /* Hide by default - display:none is enough, don't add height:0 or overflow:hidden */
    }

    section[id^="tab-"].active-view {
      display: block !important;
      /* Show when active */
      opacity: 1 !important;
      height: auto !important;
      min-height: 100vh;
      overflow: visible !important;
    }

    .card {
      background: var(--card);
      border: 1px solid var(--glass-border);
      border-radius: 20px;
      padding: var(--space-xl);
      box-shadow: var(--card-shadow);
      -webkit-backdrop-filter: var(--glass-blur);
      backdrop-filter: var(--glass-blur);
      overflow: visible;
      transition: transform var(--transition-base), box-shadow var(--transition-base);
    }

    .card:hover {
      transform: translateY(-2px);
      box-shadow: var(--card-shadow), 0 12px 40px rgba(0, 0, 0, 0.15);
    }

    .card.no-hover:hover {
      transform: none;
      box-shadow: var(--card-shadow);
    }

    .recipe-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 24px;
      padding: 24px 0;
    }

    .recipe-card {
      position: relative;
      height: 380px;
      border-radius: 24px;
      overflow: hidden;
      cursor: pointer;
      border: 1px solid var(--glass-border);
      background: var(--bg-elevated);
      transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), box-shadow 0.4s ease;
      /* GPU acceleration */
      transform: translateZ(0);
      /* Performance: defer rendering of off-screen cards */
      content-visibility: auto;
      contain-intrinsic-size: auto 380px;
    }

    .recipe-card:hover {
      transform: translateY(-8px) scale(1.02) translateZ(0);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
      z-index: 10;
      /* Only use will-change on hover */
      will-change: transform, box-shadow;
    }

    .recipe-card-image {
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
      transition: transform 0.6s ease;
      /* GPU acceleration */
      transform: translateZ(0);
    }

    .recipe-card:hover .recipe-card-image {
      transform: scale(1.1) translateZ(0);
      will-change: transform;
    }

    .recipe-card-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(to top, rgba(0, 0, 0, 0.9) 0%, rgba(0, 0, 0, 0.4) 50%, transparent 100%);
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 24px;
      transition: background 0.3s ease;
      z-index: 2;
      pointer-events: none;
    }

    .recipe-card-overlay * {
      pointer-events: auto;
    }

    .recipe-card:hover .recipe-card-overlay {
      background: linear-gradient(to top, rgba(0, 0, 0, 0.95) 0%, rgba(0, 0, 0, 0.2) 100%);
    }

    .recipe-card-badge {
      position: absolute;
      top: 16px;
      right: 16px;
      padding: 6px 12px;
      background: var(--glass-bg);
      -webkit-backdrop-filter: var(--glass-blur);
      backdrop-filter: var(--glass-blur);
      border: 1px solid var(--glass-border);
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      color: #fff;
      z-index: 2;
    }

    .recipe-card-title {
      font-size: 20px;
      font-weight: 700;
      color: #fff;
      margin-bottom: 8px;
      line-height: 1.2;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .recipe-card-meta {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 13px;
      color: rgba(255, 255, 255, 0.7);
    }

    .recipe-card-actions {
      position: absolute;
      top: 16px;
      left: 16px;
      display: flex;
      gap: 8px;
      align-items: center;
      /* Fix alignment */
      opacity: 1;
      transform: translateY(0);
      transition: all 0.3s ease;
      z-index: 20;
      /* Ensure above overlay and hover effects */
      pointer-events: auto;
      /* Ensure clickable */
    }

    .recipe-card:hover .recipe-card-actions {
      opacity: 1;
      transform: translateY(0);
    }

    /* Recipe Actions & Selection UI */
    /* Recipe Actions & Selection UI */
    .card-action-btn {
      width: 36px !important;
      height: 36px !important;
      border-radius: 12px;
      background: rgba(0, 0, 0, 0.6);
      -webkit-backdrop-filter: var(--glass-blur);
      backdrop-filter: var(--glass-blur);
      border: 1px solid rgba(255, 255, 255, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 18px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      transform: translateZ(0);
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      flex-shrink: 0;
      position: relative;
    }

    .card-action-btn:hover {
      background: var(--accent);
      border-color: var(--accent);
      color: #000;
      transform: scale(1.1) translateZ(0);
    }

    .card-action-btn[data-action="recipe-favorite"] {
      font-size: 20px;
    }

    /* Selection Checkbox using Label Wrapper */
    .recipe-card-actions .recipe-select-label {
      padding: 0 !important;
      margin: 0 !important;
      overflow: hidden;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      width: 36px !important;
      height: 36px !important;
      min-height: 0 !important;
      max-height: 36px !important;
      position: relative;
    }

    /* Unchecked state - show empty box icon */
    .recipe-card-actions .recipe-select-label::after {
      content: '☐';
      font-size: 20px;
      position: absolute;
      z-index: 5;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      pointer-events: none;
      color: #fff;
      display: block;
    }

    .recipe-card-actions .recipe-select-checkbox {
      opacity: 0;
      position: absolute;
      width: 100%;
      height: 100%;
      cursor: pointer;
      margin: 0;
      padding: 0;
      z-index: 10;
      appearance: none;
      -webkit-appearance: none;
      min-height: 0 !important;
      top: 0;
      left: 0;
    }

    /* Checked state - show checkmark (using SVG background for fail-safe visibility) */
    .recipe-card-actions .recipe-select-label.checked {
      background-color: var(--accent) !important;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='4' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='20 6 9 17 4 12'/%3E%3C/svg%3E") !important;
      background-position: center !important;
      background-repeat: no-repeat !important;
      background-size: 22px !important;
      border-color: var(--accent) !important;
      box-shadow: 0 0 10px var(--accent);
    }

    /* Checkmark Overlay (Physical Element) */
    .recipe-card-actions .checkmark-overlay {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 10px;
      /* Bigger touch target visually */
      height: 18px;
      border: solid #fff;
      border-width: 0 3px 3px 0;
      transform: translate(-50%, -60%) rotate(45deg);
      opacity: 0;
      /* Hidden by default */
      transition: opacity 0.1s ease;
      z-index: 15;
      /* Above input */
      pointer-events: none;
      /* Let clicks pass */
    }

    /* Show when checked */
    .recipe-card-actions .recipe-select-label.checked .checkmark-overlay {
      opacity: 1;
    }

    /* Cleanup old pseudo-element styles to avoid ghosts */
    .recipe-card-actions .recipe-select-label::after {
      display: none !important;
    }

    /* Hover state */
    .recipe-card-actions .recipe-select-label:hover {
      background: var(--accent);
      border-color: var(--accent);
    }

    .recipe-card-actions .recipe-select-label:hover::after {
      color: #000;
    }

    .recipe-card:has(.recipe-select-label.checked) {
      outline: 3px solid var(--accent);
      outline-offset: -3px;
    }

    /* Meal Type Color Coding - Left border indicator */
    .recipe-card[data-meal-type="Breakfast"] {
      border-left: 4px solid var(--accent-secondary);
    }

    .recipe-card[data-meal-type="Brunch"] {
      border-left: 4px solid #f59e0b;
    }

    .recipe-card[data-meal-type="Lunch"] {
      border-left: 4px solid var(--accent);
    }

    .recipe-card[data-meal-type="Dinner"] {
      border-left: 4px solid var(--accent-deep);
    }

    .recipe-card[data-meal-type="Dessert"] {
      border-left: 4px solid #ec4899;
    }

    .recipe-card[data-meal-type="Appetizer"] {
      border-left: 4px solid #8b5cf6;
    }

    .recipe-card[data-meal-type="Side Dish"] {
      border-left: 4px solid #14b8a6;
    }

    .recipe-card[data-meal-type="Sauce"] {
      border-left: 4px solid #f97316;
    }

    .recipe-card[data-meal-type="Beverage"] {
      border-left: 4px solid #06b6d4;
    }

    /* Recipe Sort Options */
    .recipe-sort-bar {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid var(--glass-border);
      border-radius: 12px;
      margin-bottom: 16px;
    }

    .recipe-sort-bar label {
      font-size: 13px;
      color: var(--muted);
      font-weight: 500;
    }

    .recipe-sort-select {
      padding: 8px 12px;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--glass-border);
      color: var(--text);
      font-size: 13px;
      cursor: pointer;
      min-width: 140px;
    }

    .recipe-sort-select:hover {
      border-color: var(--accent);
    }

    .recipe-count-badge {
      margin-left: auto;
      padding: 6px 12px;
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid rgba(16, 185, 129, 0.2);
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      color: var(--accent);
    }

    /* ========== PHASE 4: Search Enhancements ========== */
    .search-input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .search-input-wrapper .search-icon {
      position: absolute;
      left: 12px;
      color: var(--muted);
      pointer-events: none;
      z-index: 1;
    }

    .search-input-wrapper input {
      padding-left: 40px !important;
      padding-right: 16px !important;
      flex: 1;
    }

    .search-clear-btn {
      position: relative;
      margin-left: 8px;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid var(--glass-border);
      padding: 8px;
      cursor: pointer;
      color: var(--muted);
      border-radius: 8px;
      display: none;
      transition: all var(--transition-fast);
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .search-clear-btn:hover {
      background: rgba(255, 255, 255, 0.15);
      border-color: var(--accent);
      color: var(--text);
    }

    .search-clear-btn svg {
      display: block;
    }

    .search-input-wrapper:has(input:not(:placeholder-shown)) .search-clear-btn,
    .search-input-wrapper:has(input.has-value) .search-clear-btn {
      display: flex;
    }

    .search-autocomplete {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-top: none;
      border-radius: 0 0 12px 12px;
      max-height: 300px;
      overflow-y: auto;
      z-index: 100;
      display: none;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
    }

    /* Solid background fallback for autocomplete */
    .search-autocomplete::before {
      content: '';
      position: absolute;
      inset: 0;
      background: #1a1f2e;
      border-radius: inherit;
      z-index: -1;
    }

    .search-autocomplete.visible {
      display: block;
    }

    .search-autocomplete-item {
      padding: 10px 14px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      border-bottom: 1px solid var(--glass-border);
      transition: background var(--transition-fast);
      background: transparent;
    }

    .search-autocomplete-item:last-child {
      border-bottom: none;
    }

    .search-autocomplete-item:hover,
    .search-autocomplete-item.selected {
      background: rgba(16, 185, 129, 0.15);
    }

    .search-autocomplete-item .item-title {
      flex: 1;
      font-size: 14px;
    }

    .search-autocomplete-item .item-title mark {
      background: rgba(16, 185, 129, 0.3);
      color: inherit;
      border-radius: 2px;
      padding: 0 2px;
    }

    .search-autocomplete-item .item-meta {
      font-size: 11px;
      color: var(--muted);
    }

    .recent-searches {
      margin-top: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .recent-searches:empty {
      display: none;
    }

    .recent-searches-label {
      font-size: 11px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .recent-search-chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--glass-border);
      border-radius: 16px;
      font-size: 12px;
      color: var(--text);
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .recent-search-chip:hover {
      background: rgba(16, 185, 129, 0.1);
      border-color: var(--accent);
    }

    .recent-search-chip .chip-remove {
      display: flex;
      padding: 2px;
      border-radius: 50%;
      opacity: 0.6;
    }

    .recent-search-chip .chip-remove:hover {
      opacity: 1;
      background: rgba(255, 255, 255, 0.1);
    }

    .row {
      display: grid;
      grid-template-columns: repeat(12, minmax(0, 1fr));
      gap: 10px;
      align-items: end;
    }

    .row.align-top {
      align-items: start;
    }

    .col-12 {
      grid-column: span 12
    }

    .col-8 {
      grid-column: span 12
    }

    .col-6 {
      grid-column: span 12
    }

    .col-4 {
      grid-column: span 12
    }

    .col-3 {
      grid-column: span 12
    }

    .col-2 {
      grid-column: span 12
    }

    @media (min-width: 720px) {
      .col-8 {
        grid-column: span 8
      }

      .col-6 {
        grid-column: span 6
      }

      .col-4 {
        grid-column: span 4
      }

      .col-3 {
        grid-column: span 3
      }

      .col-2 {
        grid-column: span 2
      }
    }

    label {
      font-size: 12px;
      color: var(--text-secondary);
      display: block;
      margin-bottom: 6px;
      font-weight: 500;
    }

    input,
    select,
    textarea {
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid var(--line);
      background: var(--bg-elevated);
      color: var(--text);
      box-sizing: border-box;
      min-height: 42px;
      font-size: 14px;
    }

    /* Match color-scheme to theme */
    :root[data-theme="dark"] input,
    :root[data-theme="dark"] select,
    :root[data-theme="dark"] textarea {
      color-scheme: dark;
    }

    :root[data-theme="light"] input,
    :root[data-theme="light"] select,
    :root[data-theme="light"] textarea {
      color-scheme: light;
    }

    /* Default to dark color-scheme (matches app default dark theme) */
    :root:not([data-theme]) input,
    :root:not([data-theme]) select,
    :root:not([data-theme]) textarea,
    :root[data-theme=""] input,
    :root[data-theme=""] select,
    :root[data-theme=""] textarea {
      color-scheme: dark;
    }

    /* Date picker calendar icon - force WHITE across all themes */
    input[type="date"]::-webkit-calendar-picker-indicator {
      filter: brightness(0) invert(1);
      cursor: pointer;
      opacity: 1;
    }

    input[type="date"]::-webkit-calendar-picker-indicator:hover {
      opacity: 0.8;
    }

    /* Ensure light theme also has white icons */
    :root[data-theme="light"] input[type="date"]::-webkit-calendar-picker-indicator {
      filter: brightness(0) invert(1);
      opacity: 1;
    }

    input:hover,
    select:hover,
    textarea:hover {
      border-color: var(--line-strong);
      background: var(--card);
    }

    input:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: var(--accent);
      background: var(--card);
      box-shadow: 0 0 0 3px var(--line-focus);
    }

    textarea {
      min-height: 90px;
      resize: vertical;
    }

    .actions {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
      overflow: visible;
    }

    button {
      padding: 10px 14px;
      border-radius: 10px;
      border: 1px solid var(--line);
      background: rgba(77, 163, 255, 0.15);
      color: var(--text);
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all var(--transition-fast);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    button:hover:not(:disabled) {
      background: rgba(77, 163, 255, 0.25);
      border-color: var(--accent);
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(77, 163, 255, 0.2);
    }

    button:active:not(:disabled) {
      transform: translateY(0) scale(0.98);
      transition: transform 50ms ease;
    }

    button.primary {
      background: var(--accent);
      color: #ffffff;
      font-weight: 600;
      border: none;
      box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
    }

    button.primary:hover:not(:disabled) {
      background: var(--accent-hover);
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
    }

    button.primary:active:not(:disabled) {
      background: var(--accent-pressed);
    }

    button.ghost {
      background: rgba(255, 255, 255, 0.04);
      border-color: var(--line);
      overflow: visible;
    }

    button.ghost:hover:not(:disabled) {
      background: rgba(255, 255, 255, 0.08);
      border-color: var(--line-strong);
    }

    button.danger {
      background: rgba(255, 107, 107, 0.15);
      border-color: rgba(255, 107, 107, 0.3);
      color: var(--danger);
    }

    button.danger:hover:not(:disabled) {
      background: rgba(255, 107, 107, 0.25);
      border-color: var(--danger);
      box-shadow: 0 2px 8px rgba(255, 107, 107, 0.2);
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .hr {
      height: 1px;
      background: var(--line);
      margin: 12px 0;
    }

    .list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .item {
      padding: 12px;
      border-radius: 12px;
      border: 1px solid var(--line);
      background: var(--bg-elevated);
      transition: all 0.2s ease;
      overflow: visible;
      /* Allow dropdowns to overflow */
    }

    .item:hover {
      border-color: var(--line-strong);
      background: var(--card);
      transform: translateX(2px);
    }

    .pill {
      display: inline-block;
      padding: 5px 10px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 500;
      border: 1px solid var(--line);
      background: rgba(255, 255, 255, 0.04);
      color: var(--text-secondary);
      margin-right: 6px;
    }

    .pill.accent {
      border-color: rgba(77, 163, 255, 0.6);
      background: rgba(77, 163, 255, 0.15);
      color: var(--accent);
    }

    a {
      color: var(--accent);
      text-decoration: none;
    }

    details {
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 10px;
      background: rgba(255, 255, 255, 0.02);
    }

    summary {
      cursor: pointer;
      user-select: none;
      font-weight: 700;
    }

    summary {
      list-style: none;
      cursor: pointer;
    }

    summary::-webkit-details-marker {
      display: none;
    }

    summary::marker {
      display: none;
    }

    summary:before {
      content: "▶";
      display: inline-block;
      margin-right: 8px;
      color: rgba(255, 255, 255, 0.7);
      transform: translateY(-1px);
    }

    details[open] summary:before {
      content: "▼";
    }

    .modalBack {
      position: fixed;
      inset: 0;
      background: var(--overlay);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 16px;
      z-index: 100;
      -webkit-backdrop-filter: blur(4px);
      backdrop-filter: blur(4px);
    }

    /* Ensure the Recipe modal appears above the Meal Picker when both are open */
    #recipeModalBack {
      z-index: 110;
    }

    #mealPickerBack {
      z-index: 100;
    }

    .modal {
      width: min(1020px, 100%);
      background: var(--card-elevated);
      border: 1px solid var(--line-strong);
      border-radius: 16px;
      padding: 14px;
      box-shadow: 0 16px 48px rgba(0, 0, 0, 0.6);
      max-height: 92vh;
      overflow: auto;
    }

    .modalHead {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      position: sticky;
      top: 0;
      background: var(--card-elevated);
      padding-bottom: 8px;
      z-index: 2;
      border-bottom: 1px solid var(--line);
      margin-bottom: 12px;
    }

    .storeBadge {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 999px;
      font-size: 12px;
      border: 1px solid var(--line);
      background: rgba(255, 255, 255, 0.04);
      color: var(--text-secondary);
      margin-left: 8px;
    }

    .mini {
      font-size: 12px;
      padding: 7px 10px;
      border-radius: 10px;
    }

    /* Shopping List Styles */
    .shop-group {
      margin-bottom: 24px;
      background: var(--bg-elevated);
      border: 1px solid var(--line);
      border-radius: 12px;
      overflow: hidden;
    }

    .shop-group-header {
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.03);
      border-bottom: 1px solid var(--line);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .shop-group-header h3 {
      margin: 0;
      font-size: 14px;
      font-weight: 600;
      color: var(--accent);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .shop-group-count {
      font-size: 11px;
      color: var(--text-tertiary);
      background: rgba(0, 0, 0, 0.2);
      padding: 2px 8px;
      border-radius: 12px;
    }

    .shop-items {
      padding: 8px;
    }

    .shop-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 12px;
      border-radius: 8px;
      transition: background 0.2s ease;
    }

    .shop-item:hover {
      background: rgba(255, 255, 255, 0.03);
    }

    .shop-item-check {
      display: flex;
      align-items: center;
    }

    .shop-item-details {
      flex: 1;
      min-width: 0;
    }

    .shop-item-name {
      font-size: 14px;
      color: var(--text-primary);
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .shop-item-meta {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 2px;
    }

    .shop-item-actions-wrapper {
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 12px;
      flex-shrink: 0;
    }

    .shop-item-actions {
      display: flex;
      flex-direction: row;
      gap: 6px;
      opacity: 0.8 !important;
      transform: none !important;
    }

    .shop-item-actions button {
      padding: 6px 10px;
      white-space: nowrap;
    }

    .shop-item:hover .shop-item-actions {
      opacity: 1 !important;
      transform: none !important;
    }

    .icon-merge {
      font-size: 14px;
      cursor: help;
      color: #ffd700;
      /* Bright Gold for visibility */
      font-weight: bold;
    }

    .btn-icon.small {
      padding: 4px;
      width: 28px;
      height: 28px;
      font-size: 14px;
      line-height: 1;
    }

    /* ========== PROFESSIONAL PREMIUM STYLING (Option A) ========== */

    /* Enhanced Card System */
    .card {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--accent) 0%, rgba(77, 163, 255, 0.3) 100%);
      opacity: 0.6;
    }

    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.4);
    }

    .card h2 {
      font-size: 18px;
      font-weight: 700;
      margin: 0 0 12px 0;
      color: var(--text);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .card h2::before {
      content: '';
      width: 4px;
      height: 20px;
      background: linear-gradient(135deg, var(--accent) 0%, rgba(77, 163, 255, 0.5) 100%);
      border-radius: 2px;
    }

    /* Enhanced Buttons */
    button {
      padding: 11px 16px;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: rgba(77, 163, 255, 0.18);
      color: var(--text);
      cursor: pointer;
      font-weight: 500;
      font-size: 14px;
      transition: all 0.2s ease;
      position: relative;
      overflow: hidden;
    }

    button::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      transform: translate(-50%, -50%);
      transition: width 0.4s ease, height 0.4s ease;
    }

    button:hover::before {
      width: 300px;
      height: 300px;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(77, 163, 255, 0.3);
      border-color: rgba(77, 163, 255, 0.4);
    }

    button.primary {
      background: linear-gradient(135deg, var(--accent) 0%, #3d8fdb 100%);
      color: #ffffff;
      font-weight: 700;
      border: none;
      box-shadow: 0 4px 12px rgba(77, 163, 255, 0.4);
    }

    button.primary:hover {
      background: linear-gradient(135deg, var(--accent-secondary) 0%, var(--accent-deep) 100%);
      box-shadow: 0 6px 16px rgba(77, 163, 255, 0.5);
      transform: translateY(-2px);
    }

    button.ghost {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }

    button.ghost:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(255, 255, 255, 0.25);
    }

    button.danger {
      background: linear-gradient(135deg, rgba(255, 107, 107, 0.25) 0%, rgba(255, 107, 107, 0.15) 100%);
      border-color: rgba(255, 107, 107, 0.4);
    }

    button.danger:hover {
      background: linear-gradient(135deg, rgba(255, 107, 107, 0.35) 0%, rgba(255, 107, 107, 0.25) 100%);
      box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
    }

    /* Enhanced Form Controls */
    input,
    select,
    textarea {
      width: 100%;
      padding: 12px 14px;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.15);
      background: rgba(255, 255, 255, 0.05);
      color: var(--text);
      box-sizing: border-box;
      min-height: 44px;
      /* color-scheme handled by global theme rules */
      transition: all 0.2s ease;
      font-size: 14px;
    }

    input:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: var(--accent);
      background: rgba(255, 255, 255, 0.08);
      box-shadow: 0 0 0 3px rgba(77, 163, 255, 0.15);
    }

    textarea {
      min-height: 100px;
      resize: vertical;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }

    /* Enhanced Items/List */
    .item {
      padding: 14px 16px;
      border-radius: 12px;
      border: 1px solid var(--line);
      background: rgba(255, 255, 255, 0.04);
      transition: all 0.2s ease;
      position: relative;
    }

    .item::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 3px;
      background: linear-gradient(180deg, var(--accent) 0%, rgba(77, 163, 255, 0.3) 100%);
      border-radius: 12px 0 0 12px;
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .item:hover {
      background: rgba(255, 255, 255, 0.06);
      border-color: rgba(77, 163, 255, 0.3);
      transform: translateX(2px);
    }

    .item:hover::before {
      opacity: 1;
    }

    /* Enhanced Pills/Badges */
    .pill {
      display: inline-block;
      padding: 5px 10px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 600;
      border: 1px solid rgba(255, 255, 255, 0.15);
      margin-right: 6px;
      background: rgba(255, 255, 255, 0.05);
      transition: all 0.2s ease;
    }

    .pill.accent {
      border-color: rgba(77, 163, 255, 0.6);
      background: rgba(77, 163, 255, 0.2);
      color: #5eb3ff;
      box-shadow: 0 2px 8px rgba(77, 163, 255, 0.2);
    }

    /* Section Headers */
    .card>label:first-of-type,
    .card h3 {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      margin: 16px 0 10px 0;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .card h3::before {
      content: '';
      width: 3px;
      height: 16px;
      background: linear-gradient(135deg, var(--accent) 0%, rgba(77, 163, 255, 0.5) 100%);
      border-radius: 2px;
    }

    /* Horizontal Divider */
    .hr {
      height: 1px;
      background: linear-gradient(90deg, transparent 0%, var(--line) 20%, var(--line) 80%, transparent 100%);
      margin: 20px 0;
      border: none;
    }

    /* Details/Accordion Enhancement */
    details {
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 14px;
      background: rgba(255, 255, 255, 0.03);
      margin-bottom: 8px;
      transition: all 0.2s ease;
    }

    details:hover {
      background: rgba(255, 255, 255, 0.05);
      border-color: rgba(77, 163, 255, 0.3);
    }

    details[open] {
      background: rgba(255, 255, 255, 0.06);
      border-color: rgba(77, 163, 255, 0.4);
    }

    summary {
      cursor: pointer;
      user-select: none;
      font-weight: 600;
      font-size: 14px;
      padding: 4px 0;
      transition: color 0.2s ease;
    }

    summary:hover {
      color: var(--accent);
    }

    /* Tab Enhancement */
    .tabs {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .tab {
      padding: 10px 16px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255, 255, 255, 0.04);
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      transition: all 0.2s ease;
      position: relative;
    }

    .tab:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(77, 163, 255, 0.3);
      transform: translateY(-1px);
    }

    .tab.active {
      background: linear-gradient(135deg, rgba(77, 163, 255, 0.3) 0%, rgba(77, 163, 255, 0.15) 100%);
      border-color: rgba(77, 163, 255, 0.7);
      color: #5eb3ff;
      font-weight: 600;
      box-shadow: 0 2px 8px rgba(77, 163, 255, 0.2);
    }

    /* Status Messages */
    .muted {
      color: var(--muted);
      font-size: 12px;
      line-height: 1.5;
    }

    #recipeStatus,
    #storeStatus,
    #calStatus,
    #clearStatus,
    #generateWeekStatus,
    #cuisineManageStatus,
    #mealPlannerPrefsStatus {
      font-size: 13px;
      padding: 4px 0;
      font-weight: 500;
    }

    /* ========== END PROFESSIONAL STYLING ========== */

    .ingGrid select,
    .ingGrid input {
      width: 100%;
      box-sizing: border-box;
    }

    .ingGrid .row {
      align-items: flex-end;
    }

    /* Letter headers for recipe list - NOT sticky */
    .letter-header {
      padding: 10px 12px;
      font-size: 14px;
      font-weight: 700;
      color: #ffffff;
      background: #1a4d7c;
      border-bottom: 2px solid var(--accent);
      border-radius: 6px;
      margin-bottom: 12px;
      margin-top: 16px;
    }

    /* Ensure recipe items don't overlap sticky headers */
    #recipesList .item {
      position: relative;
      z-index: 1;
    }

    /* Recipe scaling controls */
    .scale-controls {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 14px;
      background: linear-gradient(135deg, rgba(77, 163, 255, 0.15) 0%, rgba(77, 163, 255, 0.05) 100%);
      border: 1px solid rgba(77, 163, 255, 0.4);
      border-radius: 10px;
      margin-bottom: 14px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
    }

    .scale-controls label {
      margin: 0;
      color: var(--text);
      font-size: 13px;
      font-weight: 600;
    }

    .scale-controls button {
      padding: 8px 14px;
      font-size: 16px;
      font-weight: 600;
      background: rgba(77, 163, 255, 0.25);
      border: 1px solid rgba(77, 163, 255, 0.5);
      border-radius: 6px;
      min-width: 40px;
      color: var(--accent);
    }

    .scale-controls button:hover {
      background: rgba(77, 163, 255, 0.4);
    }

    .scale-value {
      font-weight: 700;
      min-width: 50px;
      text-align: center;
      font-size: 18px;
      color: var(--accent);
      text-shadow: 0 0 10px rgba(77, 163, 255, 0.5);
    }

    /* Auto-classification indicator */
    .auto-cat-indicator {
      font-size: 11px;
      color: var(--muted);
      margin-left: 4px;
    }

    .auto-cat-active {
      color: #22c55e;
    }

    /* Calendar Grid View */
    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 8px;
      margin-top: 12px;
    }

    .grid-day {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 8px;
      padding: 8px;
      min-height: 200px;
    }

    .grid-day-header {
      font-weight: 700;
      font-size: 12px;
      margin-bottom: 8px;
      padding-bottom: 4px;
      border-bottom: 1px solid var(--line);
      color: var(--accent);
    }

    .grid-meal {
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid rgba(255, 255, 255, 0.10);
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 8px;
      font-size: 13px;
      cursor: grab;
      transition: all 0.2s;
      min-height: 60px;
      position: relative;
      /* For absolute-positioned expand button */
    }

    .grid-meal:hover {
      background: rgba(77, 163, 255, 0.15);
      border-color: rgba(77, 163, 255, 0.4);
    }

    .grid-meal.dragging {
      opacity: 0.5;
      cursor: grabbing;
    }

    .grid-meal-label {
      font-weight: 600;
      font-size: 11px;
      color: var(--muted);
      margin-bottom: 4px;
    }

    .grid-meal-title {
      font-size: 13px;
      line-height: 1.4;
    }

    /* ========== PHASE 4.3: Enhanced Color Coding for Meal Types ========== */
    .grid-meal.breakfast {
      border-left: 3px solid #f59e0b;
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.12) 0%, rgba(245, 158, 11, 0.04) 100%);
    }

    .grid-meal.breakfast:hover {
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.22) 0%, rgba(77, 163, 255, 0.15) 100%);
    }

    .grid-meal.lunch {
      border-left: 3px solid #10b981;
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.12) 0%, rgba(16, 185, 129, 0.04) 100%);
    }

    .grid-meal.lunch:hover {
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.22) 0%, rgba(77, 163, 255, 0.15) 100%);
    }

    .grid-meal.dinner {
      border-left: 3px solid #f97316;
      background: linear-gradient(135deg, rgba(249, 115, 22, 0.12) 0%, rgba(249, 115, 22, 0.04) 100%);
    }

    .grid-meal.dinner:hover {
      background: linear-gradient(135deg, rgba(249, 115, 22, 0.22) 0%, rgba(77, 163, 255, 0.15) 100%);
    }

    .grid-meal.cuisine-italian {
      background: rgba(76, 175, 80, 0.1);
    }

    .grid-meal.cuisine-chinese {
      background: rgba(244, 67, 54, 0.1);
    }

    .grid-meal.cuisine-mexican {
      background: rgba(255, 152, 0, 0.1);
    }

    .grid-meal.cuisine-indian {
      background: rgba(156, 39, 176, 0.1);
    }

    .grid-meal.cuisine-japanese {
      background: rgba(233, 30, 99, 0.1);
    }

    .grid-meal.cuisine-american {
      background: rgba(63, 81, 181, 0.1);
    }

    /* Leftover meal indicator */
    .grid-meal.leftover-meal {
      border-left: 3px solid #a855f7;
      background: linear-gradient(135deg, rgba(168, 85, 247, 0.15) 0%, rgba(168, 85, 247, 0.05) 100%);
    }

    .grid-meal.leftover-meal:hover {
      background: linear-gradient(135deg, rgba(168, 85, 247, 0.25) 0%, rgba(77, 163, 255, 0.15) 100%);
    }

    .leftover-indicator {
      font-size: 10px;
      color: #a855f7;
      font-style: italic;
    }

    /* Multi-meal grid container */
    .grid-meal-multi {
      position: relative;
      /* For absolute-positioned expand button */
    }

    /* Grid view additional items */
    .grid-meal[data-has-additional="true"] {
      position: relative;
    }

    .grid-additional-badge {
      position: absolute;
      top: 6px;
      right: 6px;
      background: var(--accent-secondary);
      color: white;
      font-size: 11px;
      font-weight: 700;
      padding: 3px 7px;
      border-radius: 12px;
      line-height: 1.2;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      z-index: 2;
    }

    .grid-expand-btn {
      position: absolute !important;
      bottom: 6px !important;
      right: 6px !important;
      left: auto !important;
      background: linear-gradient(135deg, var(--accent-secondary) 0%, var(--accent-deep) 100%);
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      padding: 4px 8px;
      line-height: 1;
      transition: all 0.2s;
      box-shadow: 0 2px 6px rgba(77, 163, 255, 0.3);
      z-index: 2;
      font-weight: 600;
    }

    .grid-expand-btn:hover {
      background: linear-gradient(135deg, #2d7bd6 0%, #1e5aa3 100%);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(77, 163, 255, 0.4);
    }

    /* Multi-meal expand button (same styling as single expand button) */
    .grid-expand-multi-btn {
      position: absolute !important;
      bottom: 6px !important;
      right: 6px !important;
      left: auto !important;
      background: linear-gradient(135deg, var(--accent-secondary) 0%, var(--accent-deep) 100%);
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      padding: 4px 8px;
      line-height: 1;
      transition: all 0.2s;
      box-shadow: 0 2px 6px rgba(77, 163, 255, 0.3);
      z-index: 2;
      font-weight: 600;
    }

    .grid-expand-multi-btn:hover {
      background: linear-gradient(135deg, #2d7bd6 0%, #1e5aa3 100%);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(77, 163, 255, 0.4);
    }

    .grid-additional-popover {
      background: var(--bg);
      border: 2px solid var(--accent);
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
      min-width: 250px;
      max-width: 350px;
      color: var(--fg);
    }

    .grid-empty-slot {
      background: rgba(255, 255, 255, 0.02);
      border: 1px dashed rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      padding: 6px;
      margin-bottom: 6px;
      font-size: 11px;
      color: var(--muted);
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
    }

    .grid-empty-slot:hover {
      background: rgba(77, 163, 255, 0.1);
      border-color: rgba(77, 163, 255, 0.3);
      color: var(--accent);
    }

    /* Drag and drop states */
    .drag-over {
      background: rgba(77, 163, 255, 0.2) !important;
      border-color: rgba(77, 163, 255, 0.6) !important;
    }

    /* Meal Planner Preferences Modal Styling */
    .prefs-section {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
    }

    .prefs-section-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .prefs-section-title span {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .prefs-section-title span::before {
      content: '';
      width: 4px;
      height: 18px;
      background: linear-gradient(135deg, var(--accent) 0%, rgba(77, 163, 255, 0.5) 100%);
      border-radius: 2px;
    }

    .cuisine-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 10px;
    }

    .cuisine-option {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      margin: 0;
    }

    .cuisine-option:hover {
      background: rgba(77, 163, 255, 0.08);
      border-color: rgba(77, 163, 255, 0.3);
      transform: translateY(-1px);
    }

    .cuisine-option input[type="checkbox"] {
      width: 18px;
      height: 18px;
      min-height: 18px;
      margin: 0;
      cursor: pointer;
      accent-color: var(--accent);
    }

    .cuisine-option span {
      font-size: 14px;
      color: var(--text);
      user-select: none;
    }

    .cuisine-option input[type="checkbox"]:checked+span {
      color: var(--accent);
      font-weight: 500;
    }

    .variety-options {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .variety-option {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 12px;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      margin: 0;
    }

    .variety-option:hover {
      background: rgba(77, 163, 255, 0.08);
      border-color: rgba(77, 163, 255, 0.3);
    }

    .variety-option input[type="checkbox"] {
      width: 18px;
      height: 18px;
      min-height: 18px;
      margin-top: 2px;
      cursor: pointer;
      accent-color: var(--accent);
      flex-shrink: 0;
    }

    .variety-option-content {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .variety-option-title {
      font-size: 14px;
      color: var(--text);
      user-select: none;
    }

    .variety-option-desc {
      font-size: 12px;
      color: var(--muted);
      user-select: none;
    }

    .variety-option input[type="checkbox"]:checked~.variety-option-content .variety-option-title {
      color: var(--accent);
      font-weight: 500;
    }

    .breakfast-select-wrapper {
      position: relative;
    }

    .breakfast-select-wrapper select {
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1.5L6 6.5L11 1.5' stroke='%238aa0b6' stroke-width='2' stroke-linecap='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      padding-right: 36px;
      font-size: 14px;
    }

    .prefs-save-section {
      display: flex;
      align-items: center;
      gap: 12px;
      padding-top: 8px;
    }

    .prefs-save-section button {
      min-width: 180px;
    }

    /* Companion Panel Styles */
    .companion-float-btn {
      position: fixed;
      bottom: 144px;
      left: 24px;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: var(--accent);
      color: white;
      border: none;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(77, 163, 255, 0.4);
      z-index: 999;
      transition: transform 0.2s;
    }

    .companion-float-btn:hover {
      transform: scale(1.1);
    }

    .companion-panel {
      position: fixed;
      bottom: 204px;
      left: 24px;
      width: 320px;
      max-height: calc(100vh - 240px);
      overflow-y: auto;
      background: #111827;
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
      z-index: 998;
      display: none;
    }

    .companion-panel.show {
      display: block;
    }

    .companion-status {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
      font-size: 13px;
    }

    .companion-status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #10b981;
    }

    .companion-status-dot.offline {
      background: #6b7280;
    }

    .companion-device {
      padding: 8px;
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid var(--line);
      border-radius: 8px;
      margin-bottom: 8px;
      font-size: 13px;
    }

    .companion-action-btn {
      width: 100%;
      margin-bottom: 8px;
      background: rgba(77, 163, 255, 0.18);
      border: 1px solid rgba(77, 163, 255, 0.3);
      padding: 10px;
      border-radius: 10px;
      color: var(--text);
      cursor: pointer;
      transition: background 0.2s;
    }

    .companion-action-btn:hover {
      background: rgba(77, 163, 255, 0.28);
    }

    .companion-action-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* ============= TOAST NOTIFICATIONS ============= */
    #toast-container {
      position: fixed;
      top: 120px;
      right: 20px;
      z-index: 10000;
      pointer-events: none;
    }

    .toast {
      min-width: 250px;
      max-width: 400px;
      padding: 16px 20px;
      margin-bottom: 12px;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
      display: flex;
      align-items: center;
      gap: 12px;
      pointer-events: all;
      animation: slideIn 0.3s ease-out;
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
    }

    .toast.success {
      background: rgba(16, 185, 129, 0.95);
      border-left: 4px solid #10b981;
      color: white;
    }

    .toast.error {
      background: rgba(239, 68, 68, 0.95);
      border-left: 4px solid #ef4444;
      color: white;
    }

    .toast.info {
      background: rgba(59, 130, 246, 0.95);
      border-left: 4px solid #3b82f6;
      color: white;
    }

    .toast.warning {
      background: rgba(245, 158, 11, 0.95);
      border-left: 4px solid #f59e0b;
      color: white;
    }

    .toast-icon {
      font-size: 20px;
      flex-shrink: 0;
    }

    .toast-message {
      flex: 1;
      font-size: 14px;
      line-height: 1.4;
    }

    .toast-close {
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      font-size: 18px;
      padding: 0;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0.8;
      transition: opacity 0.2s;
    }

    .toast-close:hover {
      opacity: 1;
    }

    @keyframes slideIn {
      from {
        transform: translateX(400px);
        opacity: 0;
      }

      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    @keyframes slideOut {
      from {
        transform: translateX(0);
        opacity: 1;
      }

      to {
        transform: translateX(400px);
        opacity: 0;
      }
    }

    .toast.hiding {
      animation: slideOut 0.3s ease-in forwards;
    }

    /* ============= LOADING STATES ============= */
    .spinner {
      display: inline-block;
      width: 14px;
      height: 14px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-top-color: white;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    button.loading {
      position: relative;
      pointer-events: none;
      opacity: 0.7;
    }

    button.loading::before {
      content: '';
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 14px;
      height: 14px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-top-color: currentColor;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    button.loading>* {
      opacity: 0;
    }

    /* ============= PHASE 5.5: SKELETON LOADERS ============= */

    /* Base skeleton element */
    .skeleton {
      background: linear-gradient(90deg,
          var(--bg-elevated) 0%,
          var(--card) 50%,
          var(--bg-elevated) 100%);
      background-size: 200% 100%;
      animation: shimmer 1.5s ease-in-out infinite;
      border-radius: 8px;
      position: relative;
      overflow: hidden;
    }

    @keyframes shimmer {
      0% {
        background-position: 200% 0;
      }

      100% {
        background-position: -200% 0;
      }
    }

    /* Skeleton variants */
    .skeleton-text {
      height: 16px;
      margin-bottom: 8px;
      border-radius: 4px;
    }

    .skeleton-text.h1 {
      height: 24px;
      width: 60%;
    }

    .skeleton-text.h2 {
      height: 20px;
      width: 40%;
    }

    .skeleton-title {
      height: 20px;
      width: 70%;
      margin-bottom: 12px;
    }

    .skeleton-line {
      height: 14px;
      width: 100%;
      margin-bottom: 8px;
    }

    .skeleton-line.short {
      width: 60%;
    }

    .skeleton-line.medium {
      width: 80%;
    }

    .skeleton-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
    }

    .skeleton-button {
      height: 42px;
      width: 120px;
      border-radius: 10px;
    }

    .skeleton-card {
      padding: 16px;
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 16px;
      margin-bottom: 12px;
    }

    /* Recipe list skeleton */
    .skeleton-recipe-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .skeleton-recipe-item {
      display: flex;
      gap: 12px;
      padding: 12px;
      background: var(--bg-elevated);
      border: 1px solid var(--line);
      border-radius: 12px;
    }

    .skeleton-recipe-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    /* Meal planner skeleton */
    .skeleton-planner {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 12px;
    }

    .skeleton-day-card {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 12px;
      min-height: 200px;
    }

    .skeleton-meal-slot {
      margin-top: 12px;
      padding: 10px;
      background: var(--bg-elevated);
      border: 1px solid var(--line);
      border-radius: 8px;
    }

    /* User switcher skeleton */
    .skeleton-user-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 16px;
    }

    .skeleton-user-card {
      padding: 20px;
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
    }

    /* Loading overlay */
    .loading-overlay {
      position: absolute;
      inset: 0;
      background: var(--overlay-light);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      backdrop-filter: blur(2px);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
    }

    .loading-overlay.active {
      opacity: 1;
      pointer-events: all;
    }

    .loading-spinner {
      width: 48px;
      height: 48px;
      border: 4px solid var(--line);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    /* Fade in content after loading */
    .fade-in {
      animation: fadeIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* ============= END SKELETON LOADERS ============= */

    /* ============= PHASE 5.5: VIEW TRANSITIONS & MICRO-INTERACTIONS ============= */

    /* Modal animations */
    .modalBack {
      animation: fadeInBackdrop 0.3s ease-out;
    }

    .modalBack .modal {
      animation: slideUpModal 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    }

    @keyframes fadeInBackdrop {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    @keyframes slideUpModal {
      from {
        opacity: 0;
        transform: translateY(20px) scale(0.98);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    /* Tab transition */
    .tab-content {
      animation: fadeInTab 0.2s ease-out;
    }

    @keyframes fadeInTab {
      from {
        opacity: 0;
        transform: translateY(5px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Micro-interactions */

    /* Button ripple effect */
    button:not(.no-ripple) {
      position: relative;
      overflow: hidden;
    }

    button:not(.no-ripple)::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.4);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    button:not(.no-ripple):active::after {
      width: 200px;
      height: 200px;
      transition: width 0s, height 0s;
    }

    /* Checkbox check animation */
    input[type="checkbox"] {
      transition: transform 0.1s ease;
    }

    input[type="checkbox"]:checked {
      animation: checkBounce 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    @keyframes checkBounce {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.2);
      }
    }

    /* Star favorite animation */
    .recipe-favorite-star {
      transition: transform 0.2s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    .recipe-favorite-star:active,
    .recipe-favorite-star.favoriting {
      animation: starBounce 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    @keyframes starBounce {

      0%,
      100% {
        transform: scale(1) rotate(0deg);
      }

      25% {
        transform: scale(1.3) rotate(-10deg);
      }

      75% {
        transform: scale(1.3) rotate(10deg);
      }
    }

    /* Pill/badge entrance */
    .pill {
      animation: pillEntrance 0.2s ease-out;
    }

    @keyframes pillEntrance {
      from {
        opacity: 0;
        transform: scale(0.8);
      }

      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    /* Card hover lift */
    .card {
      transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1),
        box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Toast notification slide */
    .toast {
      animation: toastSlideIn 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    }

    @keyframes toastSlideIn {
      from {
        opacity: 0;
        transform: translateX(100%) translateY(0);
      }

      to {
        opacity: 1;
        transform: translateX(0) translateY(0);
      }
    }

    .toast.hiding {
      animation: toastSlideOut 0.3s cubic-bezier(0.4, 0, 0.6, 1) forwards;
    }

    @keyframes toastSlideOut {
      from {
        opacity: 1;
        transform: translateX(0) translateY(0);
      }

      to {
        opacity: 0;
        transform: translateX(100%) translateY(0);
      }
    }

    /* Input focus pulse */
    input:focus,
    select:focus,
    textarea:focus {
      animation: inputFocusPulse 0.3s ease-out;
    }

    @keyframes inputFocusPulse {
      0% {
        box-shadow: 0 0 0 0 var(--line-focus);
      }

      50% {
        box-shadow: 0 0 0 4px var(--line-focus);
      }

      100% {
        box-shadow: 0 0 0 3px var(--line-focus);
      }
    }

    /* Dropdown slide in */
    .user-switcher-dropdown,
    .context-menu {
      animation: dropdownSlide 0.2s cubic-bezier(0.16, 1, 0.3, 1);
      transform-origin: top;
    }

    @keyframes dropdownSlide {
      from {
        opacity: 0;
        transform: translateY(-10px) scale(0.95);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    /* Loading state pulse */
    .loading-pulse {
      animation: pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: 0.5;
      }
    }

    /* Stagger children animation */
    .stagger-children>* {
      animation: fadeInUp 0.3s ease-out backwards;
    }

    .stagger-children>*:nth-child(1) {
      animation-delay: 0.05s;
    }

    .stagger-children>*:nth-child(2) {
      animation-delay: 0.1s;
    }

    .stagger-children>*:nth-child(3) {
      animation-delay: 0.15s;
    }

    .stagger-children>*:nth-child(4) {
      animation-delay: 0.2s;
    }

    .stagger-children>*:nth-child(5) {
      animation-delay: 0.25s;
    }

    .stagger-children>*:nth-child(n+6) {
      animation-delay: 0.3s;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(15px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Scale entrance for cards */
    .scale-in {
      animation: scaleIn 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    }

    @keyframes scaleIn {
      from {
        opacity: 0;
        transform: scale(0.9);
      }

      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    /* Shake animation for errors */
    .shake {
      animation: shake 0.4s cubic-bezier(0.36, 0.07, 0.19, 0.97);
    }

    @keyframes shake {

      0%,
      100% {
        transform: translateX(0);
      }

      10%,
      30%,
      50%,
      70%,
      90% {
        transform: translateX(-8px);
      }

      20%,
      40%,
      60%,
      80% {
        transform: translateX(8px);
      }
    }

    /* Smooth scroll behavior */
    html {
      scroll-behavior: smooth;
    }

    /* Reduce motion for users who prefer it */
    @media (prefers-reduced-motion: reduce) {

      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
    }

    /* ============= PHASE 9.8: ANIMATION PERFORMANCE OPTIMIZATIONS ============= */

    /* GPU acceleration hints for animated elements */
    .modal,
    .modalBack,
    .toast,
    .tour-card,
    .tour-spotlight,
    .user-switcher-dropdown,
    .context-menu,
    .grid-meal,
    .recipe-card-wrapper,
    button:hover,
    .card:hover {
      will-change: transform;
    }

    /* Composite layer hints for frequently animated properties */
    .spinner,
    .loading-spinner,
    .skeleton {
      will-change: transform, opacity;
    }

    /* Optimize modal transitions */
    .modal {
      transform: translateZ(0);
      /* Force GPU layer */
      backface-visibility: hidden;
    }

    /* Optimize toast animations */
    .toast {
      transform: translateZ(0);
      backface-visibility: hidden;
    }

    /* Pause animations when tab is hidden (battery saving) */
    @media (prefers-reduced-motion: no-preference) {

      body:not(.tab-visible) .skeleton,
      body:not(.tab-visible) .spinner,
      body:not(.tab-visible) .loading-spinner,
      body:not(.tab-visible) .loading-pulse,
      body:not(.tab-visible) .tour-spotlight {
        animation-play-state: paused;
      }
    }

    /* Optimize grid meal drag animations */
    .grid-meal.dragging {
      will-change: transform, opacity;
      transform: translateZ(0);
    }

    /* Optimize recipe card dragging */
    .recipe-card-wrapper.dragging {
      will-change: transform, opacity;
      transform: translateZ(0);
    }

    /* Remove will-change after animation completes */
    .card:not(:hover),
    button:not(:hover),
    .grid-meal:not(:hover):not(.dragging),
    .recipe-card-wrapper:not(.dragging) {
      will-change: auto;
    }

    /* Force compositing for performance-critical elements */
    .calendar-grid {
      transform: translateZ(0);
    }

    #recipesList {
      transform: translateZ(0);
    }

    /* Optimize scroll performance */
    .modal,
    #recipesList,
    .calendar-grid {
      -webkit-overflow-scrolling: touch;
    }

    /* ============= END PHASE 9.8 ============= */

    /* ============= END VIEW TRANSITIONS & MICRO-INTERACTIONS ============= */

    /* ============= PHASE 8.1: FIRST-RUN TOUR ============= */

    /* Tour overlay backdrop */
    .tour-overlay {
      position: fixed;
      inset: 0;
      z-index: 9999;
      pointer-events: all;
    }

    /* Tour spotlight - highlights target element */
    .tour-spotlight {
      position: absolute;
      border: 3px solid var(--accent);
      border-radius: 12px;
      box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.75),
        0 0 20px rgba(77, 163, 255, 0.6),
        inset 0 0 20px rgba(77, 163, 255, 0.3);
      pointer-events: none;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      animation: spotlightPulse 2s ease-in-out infinite;
    }

    @keyframes spotlightPulse {

      0%,
      100% {
        box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.75),
          0 0 20px rgba(77, 163, 255, 0.6),
          inset 0 0 20px rgba(77, 163, 255, 0.3);
      }

      50% {
        box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.75),
          0 0 30px rgba(77, 163, 255, 0.8),
          inset 0 0 30px rgba(77, 163, 255, 0.5);
      }
    }

    /* Tour card - floating instruction card */
    .tour-card {
      position: absolute;
      background: var(--card-elevated);
      border: 1px solid var(--line-strong);
      border-radius: 16px;
      padding: 0;
      box-shadow: 0 16px 48px rgba(0, 0, 0, 0.8);
      max-width: 420px;
      min-width: 320px;
      z-index: 10000;
      animation: tourCardEntrance 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    }

    @keyframes tourCardEntrance {
      from {
        opacity: 0;
        transform: translateY(20px) scale(0.95);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .tour-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 20px 16px 20px;
      border-bottom: 1px solid var(--line);
    }

    .tour-card-header h3 {
      margin: 0;
      font-size: 18px;
      font-weight: 700;
      color: var(--text-primary);
    }

    .tour-close-btn {
      background: transparent;
      border: none;
      font-size: 20px;
      cursor: pointer;
      color: var(--text-tertiary);
      padding: 4px 8px;
      border-radius: 6px;
      transition: all 0.2s ease;
      line-height: 1;
    }

    .tour-close-btn:hover {
      background: rgba(255, 255, 255, 0.08);
      color: var(--text-primary);
      transform: none;
      box-shadow: none;
    }

    .tour-card-body {
      padding: 20px;
    }

    .tour-card-body p {
      margin: 0 0 16px 0;
      font-size: 15px;
      line-height: 1.6;
      color: var(--text-secondary);
    }

    .tour-step-counter {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 8px 0 0 0;
    }

    .tour-step-counter span {
      font-size: 13px;
      color: var(--text-tertiary);
      font-weight: 500;
    }

    .tour-card-footer {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 16px 20px 20px 20px;
      border-top: 1px solid var(--line);
    }

    .tour-card-footer button {
      white-space: nowrap;
    }

    /* Ensure tour elements are above everything else */
    .tour-overlay,
    .tour-spotlight,
    .tour-card {
      user-select: none;
    }

    /* ============= END FIRST-RUN TOUR ============= */

    /* ============= PHASE 8.2: CONTEXTUAL HELP & TOOLTIPS ============= */

    /* Tooltip system - using data-tooltip attribute */
    [data-tooltip] {
      position: relative;
      cursor: help;
    }

    [data-tooltip]::before {
      content: attr(data-tooltip);
      position: absolute;
      bottom: calc(100% + 8px);
      left: 50%;
      transform: translateX(-50%) translateY(-4px);
      padding: 8px 12px;
      background: var(--bg);
      color: var(--text);
      font-size: 13px;
      line-height: 1.4;
      white-space: nowrap;
      border-radius: 8px;
      border: 1px solid var(--line-strong);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease, transform 0.2s ease;
      z-index: 10001;
      max-width: 300px;
      white-space: normal;
    }

    [data-tooltip]::after {
      content: '';
      position: absolute;
      bottom: calc(100% + 2px);
      left: 50%;
      transform: translateX(-50%);
      border: 6px solid transparent;
      border-top-color: var(--bg);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
      z-index: 10001;
      pointer-events: none;
      /* Ensure clicks pass through */
    }

    /* Tooltip hover states - DISABLED in favor of JS global tooltips to prevent clipping */
    /*
    [data-tooltip]:hover::before,
    [data-tooltip]:hover::after {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
    */

    /* Tooltip positions */
    [data-tooltip-pos="top"]::before {
      bottom: calc(100% + 8px);
      top: auto;
      left: 50%;
      right: auto;
      transform: translateX(-50%) translateY(-4px);
    }

    [data-tooltip-pos="bottom"]::before {
      top: calc(100% + 8px);
      bottom: auto;
      left: 50%;
      right: auto;
      transform: translateX(-50%) translateY(4px);
    }

    [data-tooltip-pos="bottom"]::after {
      top: calc(100% + 2px);
      bottom: auto;
      border-top-color: transparent;
      border-bottom-color: var(--bg);
    }

    [data-tooltip-pos="left"]::before {
      right: calc(100% + 8px);
      left: auto;
      top: 50%;
      bottom: auto;
      transform: translateY(-50%) translateX(-4px);
    }

    [data-tooltip-pos="left"]::after {
      right: calc(100% + 2px);
      left: auto;
      top: 50%;
      bottom: auto;
      transform: translateY(-50%);
      border-top-color: transparent;
      border-left-color: var(--bg);
    }

    [data-tooltip-pos="right"]::before {
      left: calc(100% + 8px);
      right: auto;
      top: 50%;
      bottom: auto;
      transform: translateY(-50%) translateX(4px);
    }

    [data-tooltip-pos="right"]::after {
      left: calc(100% + 2px);
      right: auto;
      top: 50%;
      bottom: auto;
      transform: translateY(-50%);
      border-top-color: transparent;
      border-right-color: var(--bg);
    }

    [data-tooltip-pos="bottom"]:hover::before,
    [data-tooltip-pos="left"]:hover::before,
    [data-tooltip-pos="right"]:hover::before {
      transform: translateY(-50%) translateX(0);
    }

    [data-tooltip-pos="bottom"]:hover::before {
      transform: translateX(-50%) translateY(0);
    }

    /* Inline help text */
    .help-text {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      padding: 10px 12px;
      background: rgba(77, 163, 255, 0.08);
      border: 1px solid rgba(77, 163, 255, 0.2);
      border-radius: 8px;
      margin: 12px 0;
      font-size: 13px;
      line-height: 1.5;
      color: var(--text-secondary);
    }

    .help-text::before {
      content: 'ℹ️';
      font-size: 16px;
      flex-shrink: 0;
      margin-top: 1px;
    }

    .help-text.warning {
      background: rgba(245, 158, 11, 0.08);
      border-color: rgba(245, 158, 11, 0.3);
    }

    .help-text.warning::before {
      content: '⚠️';
    }

    .help-text.success {
      background: rgba(16, 185, 129, 0.08);
      border-color: rgba(16, 185, 129, 0.3);
    }

    .help-text.success::before {
      content: '✓';
    }

    /* Help icon button */
    .help-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: rgba(77, 163, 255, 0.15);
      color: var(--accent);
      font-size: 12px;
      font-weight: 700;
      cursor: help;
      margin-left: 6px;
      border: 1px solid rgba(77, 163, 255, 0.3);
      transition: all 0.2s ease;
    }

    .help-icon:hover {
      background: rgba(77, 163, 255, 0.25);
      transform: scale(1.1);
    }

    /* FAQ section */
    .faq-container {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .faq-item {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 12px;
      overflow: hidden;
    }

    .faq-question {
      padding: 14px 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      transition: background 0.2s ease;
      user-select: none;
    }

    .faq-question:hover {
      background: var(--card-hover);
    }

    .faq-question-text {
      font-weight: 600;
      font-size: 14px;
      color: var(--text-primary);
    }

    .faq-toggle {
      font-size: 20px;
      color: var(--text-tertiary);
      transition: transform 0.3s ease;
      flex-shrink: 0;
    }

    .faq-item.open .faq-toggle {
      transform: rotate(180deg);
    }

    .faq-answer {
      padding: 0 16px;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease, padding 0.3s ease;
    }

    .faq-item.open .faq-answer {
      padding: 0 16px 14px 16px;
      max-height: 500px;
    }

    .faq-answer p {
      margin: 0;
      font-size: 14px;
      line-height: 1.6;
      color: var(--text-secondary);
    }

    .faq-answer ul {
      margin: 8px 0 0 0;
      padding-left: 20px;
    }

    .faq-answer li {
      margin: 4px 0;
      font-size: 14px;
      color: var(--text-secondary);
    }

    /* Help search */
    .help-search {
      position: relative;
      margin-bottom: 16px;
    }

    .help-search input {
      padding-left: 40px;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%238aa0b6' stroke-width='2'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cpath d='m21 21-4.35-4.35'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: 12px center;
    }

    .help-search-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-tertiary);
      pointer-events: none;
    }

    /* Keyboard shortcut hints */
    .kbd {
      display: inline-block;
      padding: 3px 6px;
      font-size: 11px;
      font-family: 'Courier New', monospace;
      background: var(--bg-elevated);
      border: 1px solid var(--line);
      border-radius: 4px;
      box-shadow: 0 2px 0 var(--line);
      margin: 0 2px;
      color: var(--text-secondary);
    }

    /* ============= END CONTEXTUAL HELP & TOOLTIPS ============= */

    /* ============= PHASE 8.2+: FLOATING CONTEXTUAL HELP BUTTON ============= */

    .contextual-help-btn {
      position: fixed;
      bottom: 24px;
      left: 24px;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent) 0%, #3d8fdb 100%);
      color: #ffffff;
      border: none;
      font-size: 24px;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 4px 16px rgba(77, 163, 255, 0.4);
      z-index: 1001;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .contextual-help-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 20px rgba(77, 163, 255, 0.6);
    }

    .contextual-help-btn:active {
      transform: scale(0.95);
    }

    /* Pulse animation for attention */
    @keyframes helpPulse {

      0%,
      100% {
        box-shadow: 0 4px 16px rgba(77, 163, 255, 0.4);
      }

      50% {
        box-shadow: 0 4px 16px rgba(77, 163, 255, 0.8),
          0 0 0 10px rgba(77, 163, 255, 0.1);
      }
    }

    .contextual-help-btn.pulse {
      animation: helpPulse 2s ease-in-out infinite;
    }

    /* Keyboard Shortcuts Modal Styling */
    .shortcut-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .shortcut-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 12px;
      background: var(--bg-elevated);
      border: 1px solid var(--line);
      border-radius: 8px;
      transition: all 0.2s ease;
    }

    .shortcut-item:hover {
      background: var(--card-hover);
      border-color: var(--line-strong);
      transform: translateX(4px);
    }

    .shortcut-keys {
      display: flex;
      gap: 4px;
      align-items: center;
      font-size: 12px;
    }

    .shortcut-desc {
      font-size: 13px;
      color: var(--text-secondary);
      text-align: right;
    }

    /* ============= END CONTEXTUAL HELP BUTTON & SHORTCUTS ============= */

    /* ============= ENHANCED HOVER & FOCUS STATES ============= */
    button:hover:not(:disabled):not(.loading) {
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      transition: all 0.2s ease;
    }

    button:active:not(:disabled):not(.loading) {
      transform: translateY(0);
      transition: all 0.1s ease;
    }

    .tab:hover {
      background: rgba(77, 163, 255, 0.15);
      transition: background 0.2s ease;
    }

    .item:hover {
      border-color: rgba(77, 163, 255, 0.3);
      transition: border-color 0.2s ease;
    }

    input:focus,
    select:focus,
    textarea:focus {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    button:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    /* ============= PHASE 2.1: RECIPE QUICK ACTIONS ============= */
    .recipe-card-wrapper {
      position: relative;
    }

    .recipe-quick-actions {
      position: absolute;
      top: 8px;
      right: 8px;
      opacity: 0;
      transition: opacity 0.2s ease;
      display: flex;
      gap: 4px;
      z-index: 5;
    }

    .item:hover .recipe-quick-actions {
      opacity: 1;
    }

    .quick-action-btn {
      padding: 6px 12px;
      font-size: 12px;
      background: var(--bg);
      border: 1px solid var(--line);
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.2s ease;
      color: var(--fg);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .quick-action-btn:hover {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .more-actions-btn {
      padding: 6px 10px;
      font-size: 16px;
      line-height: 1;
      background: var(--bg);
      border: 1px solid var(--line);
      border-radius: 4px;
      cursor: pointer;
      color: var(--fg);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .more-actions-btn:hover {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    /* Context Menu */
    .context-menu {
      position: absolute;
      background: var(--bg);
      border: 1px solid var(--line);
      border-radius: 8px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
      z-index: 10000;
      min-width: 200px;
      padding: 6px 0;
      display: none;
    }

    .context-menu.visible {
      display: block;
    }

    .context-menu-item {
      padding: 10px 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: background 0.15s ease;
      color: var(--fg);
      font-size: 14px;
      border: none;
      background: transparent;
      width: 100%;
      text-align: left;
    }

    .context-menu-item:hover {
      background: rgba(77, 163, 255, 0.15);
    }

    .context-menu-item:active {
      background: rgba(77, 163, 255, 0.25);
    }

    .context-menu-separator {
      height: 1px;
      background: var(--line);
      margin: 6px 0;
    }

    .context-menu-item.danger {
      color: #ef4444;
    }

    .context-menu-item.danger:hover {
      background: rgba(239, 68, 68, 0.15);
    }

    /* ============= PHASE 2.2: DRAG & DROP ENHANCEMENTS ============= */

    /* Recipe card dragging */
    .recipe-card-wrapper.dragging {
      opacity: 0.5;
      transform: rotate(2deg);
      cursor: grabbing;
    }

    .recipe-card-wrapper[draggable="true"] {
      cursor: grab;
    }

    /* Drop zone highlighting for meal slots */
    .grid-meal.drag-over-recipe,
    .grid-empty-slot.drag-over-recipe {
      background: rgba(77, 163, 255, 0.25) !important;
      border: 2px dashed var(--accent) !important;
      transform: scale(1.05);
      transition: all 0.2s ease;
      box-shadow: 0 4px 12px rgba(77, 163, 255, 0.3);
    }

    /* Visual feedback during drag */
    .meal-slot-drop-hint {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 32px;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
    }

    .grid-meal.drag-over-recipe .meal-slot-drop-hint,
    .grid-empty-slot.drag-over-recipe .meal-slot-drop-hint {
      opacity: 1;
    }

    /* Drag ghost image customization */
    .drag-ghost {
      position: fixed;
      top: -1000px;
      left: -1000px;
      padding: 12px 16px;
      background: var(--accent);
      color: white;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      pointer-events: none;
      z-index: 9999;
    }

    /* ============= PHASE 2.3: SMART SEARCH WITH FILTERS ============= */

    /* Advanced filter panel */
    .advanced-filters {
      margin-top: 12px;
      padding: 16px;
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid var(--line);
      border-radius: 12px;
      display: none;
    }

    .advanced-filters.expanded {
      display: block;
      animation: slideDown 0.3s ease-out;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .filter-section {
      margin-bottom: 16px;
    }

    .filter-section:last-child {
      margin-bottom: 0;
    }

    .filter-section-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--accent);
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .filter-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .filter-chip {
      padding: 6px 12px;
      border: 1px solid var(--line);
      border-radius: 20px;
      font-size: 12px;
      background: rgba(255, 255, 255, 0.03);
      color: var(--muted);
      cursor: pointer;
      transition: all 0.2s ease;
      user-select: none;
    }

    .filter-chip:hover {
      background: rgba(77, 163, 255, 0.1);
      border-color: var(--accent);
      color: var(--accent);
    }

    .filter-chip.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    .filter-chip.exclude {
      background: rgba(239, 68, 68, 0.2);
      border-color: rgba(239, 68, 68, 0.5);
      color: #fca5a5;
    }

    .ingredient-filter-input {
      display: flex;
      gap: 6px;
      margin-top: 8px;
    }

    .ingredient-filter-input input {
      flex: 1;
      min-width: 0;
    }

    .ingredient-filter-input button {
      flex-shrink: 0;
    }

    .ingredient-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 8px;
      min-height: 24px;
    }

    .ingredient-tag {
      padding: 4px 10px;
      background: var(--accent);
      color: white;
      border-radius: 16px;
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .ingredient-tag.exclude {
      background: #ef4444;
    }

    .ingredient-tag .remove {
      cursor: pointer;
      font-weight: bold;
      opacity: 0.8;
      transition: opacity 0.2s ease;
    }

    .ingredient-tag .remove:hover {
      opacity: 1;
    }

    .toggle-filters-btn {
      padding: 8px 14px;
      font-size: 13px;
      background: rgba(77, 163, 255, 0.1);
      border: 1px solid var(--accent);
      color: var(--accent);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .toggle-filters-btn:hover {
      background: rgba(77, 163, 255, 0.2);
    }

    .toggle-filters-btn .icon {
      transition: transform 0.3s ease;
    }

    .toggle-filters-btn.expanded .icon {
      transform: rotate(180deg);
    }

    .active-filters-badge {
      background: var(--accent);
      color: white;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
      margin-left: 4px;
    }

    .clear-filters-btn {
      padding: 6px 12px;
      font-size: 12px;
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      color: #ef4444;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .clear-filters-btn:hover {
      background: rgba(239, 68, 68, 0.2);
    }

    /* ============= PHASE 2.4: COLLECTION ENHANCEMENTS ============= */

    /* Collection card grid */
    .collections-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 16px;
      margin-top: 16px;
    }

    /* Collection card */
    .collection-card {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 16px;
      overflow: hidden;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .collection-card:hover {
      border-color: var(--accent);
      box-shadow: 0 8px 24px rgba(77, 163, 255, 0.2);
      transform: translateY(-2px);
    }

    /* Collection thumbnail grid (2x2) */
    .collection-thumbnails {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: 1fr 1fr;
      aspect-ratio: 2 / 1;
      background: linear-gradient(135deg, rgba(77, 163, 255, 0.1), rgba(77, 163, 255, 0.05));
      position: relative;
    }

    .collection-thumb {
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid var(--line);
      background: var(--bg);
      font-size: 32px;
      color: var(--muted);
      transition: all 0.2s ease;
    }

    .collection-thumb:hover {
      background: rgba(77, 163, 255, 0.1);
      transform: scale(1.05);
      z-index: 1;
    }

    .collection-thumb.more {
      font-size: 24px;
      font-weight: 600;
      color: var(--accent);
    }

    /* Collection card content */
    .collection-card-content {
      padding: 16px;
    }

    .collection-card-title {
      font-size: 16px;
      font-weight: 600;
      margin: 0 0 6px 0;
      color: var(--fg);
    }

    .collection-card-meta {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .collection-card-meta-item {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .collection-card-description {
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 12px;
      line-height: 1.4;
      max-height: 2.8em;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      -webkit-box-orient: vertical;
    }

    .collection-card-actions {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      overflow: visible !important;
    }

    .collection-card-action {
      flex: 1;
      min-width: 100px;
      padding: 8px 12px;
      font-size: 13px;
      border-radius: 8px;
      border: 1px solid var(--line);
      background: rgba(255, 255, 255, 0.03);
      color: var(--fg);
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
    }

    .collection-card-action:hover {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
      transform: translateY(-1px);
    }

    .collection-card-action.primary {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    .collection-card-action.primary:hover {
      background: #3d8fef;
    }

    /* Collection assign dropdown */
    .collection-assign-dropdown {
      position: relative;
      display: inline-block;
    }

    .collection-assign-menu {
      animation: dropdownFadeIn 0.15s ease-out;
      z-index: 10002 !important;
    }

    .collection-assign-menu[style*="block"] {
      display: block !important;
    }

    @keyframes dropdownFadeIn {
      from {
        opacity: 0;
        transform: translateY(-4px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .collection-assign-option:hover {
      background: rgba(255, 255, 255, 0.1) !important;
    }


    /* View toggle buttons */
    .view-toggle {
      display: flex;
      gap: 6px;
      align-items: center;
    }

    .view-toggle-btn {
      padding: 6px 12px;
      font-size: 13px;
      border-radius: 6px;
      border: 1px solid var(--line);
      background: rgba(255, 255, 255, 0.03);
      color: var(--muted);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .view-toggle-btn.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    .view-toggle-btn:hover:not(.active) {
      background: rgba(77, 163, 255, 0.1);
      color: var(--accent);
    }

    /* ============= PHASE 6.2: SELECTIVE EXPORT ============= */



    /* Export controls bar */
    .export-controls {
      position: sticky;
      top: 0;
      z-index: 20;
      background: linear-gradient(135deg, rgba(77, 163, 255, 0.15) 0%, rgba(77, 163, 255, 0.08) 100%);
      border: 1px solid rgba(77, 163, 255, 0.3);
      border-radius: 10px;
      padding: 12px 16px;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: 0 2px 8px rgba(77, 163, 255, 0.2);
    }



    .export-controls-text {
      flex: 1;
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
    }

    .export-controls-count {
      color: var(--accent);
      font-weight: 700;
    }

    .export-btn {
      background: linear-gradient(135deg, var(--accent) 0%, #3d8fdb 100%);
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 2px 8px rgba(77, 163, 255, 0.3);
    }

    .export-btn:hover {
      background: linear-gradient(135deg, var(--accent-secondary) 0%, var(--accent-deep) 100%);
      box-shadow: 0 4px 12px rgba(77, 163, 255, 0.4);
      transform: translateY(-1px);
    }

    .export-btn:active {
      transform: translateY(0);
    }

    /* ============= PHASE 3.1: RECENT ACTIONS HISTORY ============= */

    /* Recent actions floating button */
    .recent-actions-float-btn {
      position: fixed;
      bottom: 84px;
      left: 24px;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
      z-index: 998;
      transition: transform 0.2s;
    }

    .recent-actions-float-btn:hover {
      transform: scale(1.1);
    }

    /* Recent actions panel */
    .recent-actions-panel {
      position: fixed;
      bottom: 144px;
      left: 24px;
      width: 360px;
      max-height: 500px;
      background: #111827;
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
      z-index: 997;
      display: none;
      overflow-y: auto;
    }

    .recent-actions-panel.show {
      display: block;
      animation: slideInRight 0.3s ease-out;
    }

    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(20px);
      }

      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .recent-actions-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .recent-actions-title {
      font-size: 16px;
      font-weight: 700;
      color: var(--text);
    }

    .recent-section {
      margin-bottom: 20px;
    }

    .recent-section:last-child {
      margin-bottom: 0;
    }

    .recent-section-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--accent);
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .recent-item {
      padding: 10px 12px;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid var(--line);
      border-radius: 8px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      position: relative;
    }

    .recent-item:hover {
      background: rgba(77, 163, 255, 0.1);
      border-color: var(--accent);
      transform: translateX(-2px);
    }

    .recent-item-title {
      font-size: 14px;
      font-weight: 500;
      color: var(--text);
      margin-bottom: 4px;
    }

    .recent-item-meta {
      font-size: 12px;
      color: var(--muted);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .recent-item-time {
      font-size: 11px;
      color: var(--muted);
      opacity: 0.7;
    }

    .recent-empty {
      text-align: center;
      padding: 20px;
      color: var(--muted);
      font-size: 13px;
    }

    .recent-clear-btn {
      font-size: 12px;
      padding: 4px 10px;
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      color: #ef4444;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .recent-clear-btn:hover {
      background: rgba(239, 68, 68, 0.2);
      transform: translateY(-1px);
    }

    /* ============= PHASE 3.2: PANTRY INSIGHTS DASHBOARD ============= */

    /* Insights grid layout */
    .pantry-insights-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 16px;
      margin-bottom: 20px;
    }

    /* Insight cards */
    .insight-card {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.03) 100%);
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 16px;
      transition: all 0.2s ease;
    }

    .insight-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .insight-card.in-stock {
      border-left: 4px solid #10b981;
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(16, 185, 129, 0.03) 100%);
    }

    .insight-card.low-stock {
      border-left: 4px solid #f59e0b;
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(245, 158, 11, 0.03) 100%);
    }

    .insight-card.expiring-soon {
      border-left: 4px solid #ef4444;
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(239, 68, 68, 0.03) 100%);
    }

    .insight-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }

    .insight-card-icon {
      font-size: 32px;
      line-height: 1;
    }

    .insight-card-value {
      font-size: 36px;
      font-weight: 700;
      line-height: 1;
    }

    .in-stock .insight-card-value {
      color: #10b981;
    }

    .low-stock .insight-card-value {
      color: #f59e0b;
    }

    .expiring-soon .insight-card-value {
      color: #ef4444;
    }

    .insight-card-label {
      font-size: 13px;
      color: var(--muted);
      margin-top: 6px;
      font-weight: 500;
    }

    .insight-card-action {
      margin-top: 12px;
      padding: 8px 12px;
      font-size: 13px;
      width: 100%;
      border-radius: 8px;
      background: rgba(77, 163, 255, 0.15);
      border: 1px solid rgba(77, 163, 255, 0.3);
      color: var(--text);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .insight-card-action:hover {
      background: rgba(77, 163, 255, 0.25);
      transform: translateY(-1px);
    }

    /* Category breakdown */
    .category-breakdown {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 20px;
    }

    .category-breakdown-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 12px;
      color: var(--text);
    }

    .category-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 8px;
    }

    .category-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 12px;
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 8px;
      font-size: 13px;
    }

    .category-item-name {
      color: var(--text);
      font-weight: 500;
    }

    .category-item-count {
      color: var(--accent);
      font-weight: 600;
      font-size: 14px;
    }

    /* Expiring items list */
    .expiring-items-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .expiring-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px;
      background: rgba(239, 68, 68, 0.08);
      border: 1px solid rgba(239, 68, 68, 0.2);
      border-left: 3px solid #ef4444;
      border-radius: 8px;
      font-size: 13px;
    }

    .expiring-item-name {
      font-weight: 500;
      color: var(--text);
    }

    .expiring-item-date {
      font-size: 12px;
      color: #ef4444;
      font-weight: 600;
    }

    /* Low stock items list */
    .low-stock-items-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .low-stock-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px;
      background: rgba(245, 158, 11, 0.08);
      border: 1px solid rgba(245, 158, 11, 0.2);
      border-left: 3px solid #f59e0b;
      border-radius: 8px;
      font-size: 13px;
    }

    .low-stock-item-name {
      font-weight: 500;
      color: var(--text);
    }

    .low-stock-item-qty {
      font-size: 12px;
      color: #f59e0b;
      font-weight: 600;
    }

    .low-stock-item-actions {
      display: flex;
      gap: 4px;
    }

    .restock-btn {
      padding: 4px 10px;
      font-size: 11px;
      background: rgba(16, 185, 129, 0.2);
      border: 1px solid rgba(16, 185, 129, 0.4);
      color: #10b981;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .restock-btn:hover {
      background: rgba(16, 185, 129, 0.3);
      transform: translateY(-1px);
    }

    /* Insights toggle button */
    .insights-toggle-btn {
      margin-bottom: 16px;
      padding: 10px 16px;
      font-size: 14px;
      background: linear-gradient(135deg, rgba(77, 163, 255, 0.15) 0%, rgba(77, 163, 255, 0.08) 100%);
      border: 1px solid rgba(77, 163, 255, 0.3);
      color: var(--accent);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .insights-toggle-btn:hover {
      background: linear-gradient(135deg, rgba(77, 163, 255, 0.25) 0%, rgba(77, 163, 255, 0.15) 100%);
      transform: translateY(-1px);
    }

    .insights-toggle-icon {
      transition: transform 0.3s ease;
    }

    .insights-toggle-btn.expanded .insights-toggle-icon {
      transform: rotate(180deg);
    }

    /* Pantry insights container */
    .pantry-insights {
      display: none;
      animation: slideDown 0.3s ease-out;
    }

    .pantry-insights.visible {
      display: block;
    }

    /* ============= PHASE 4.1: EMPTY STATES ============= */

    /* Empty state container */
    .empty-state-container {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 400px;
      padding: 40px 20px;
    }

    /* Empty state card */
    .empty-state {
      text-align: center;
      max-width: 500px;
      padding: 48px 32px;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.02) 100%);
      border: 1px solid var(--line);
      border-radius: 16px;
      margin: 0 auto;
    }

    /* Empty state icon */
    .empty-state-icon {
      font-size: 64px;
      line-height: 1;
      margin-bottom: 24px;
      opacity: 0.8;
      animation: floatIcon 3s ease-in-out infinite;
    }

    @keyframes floatIcon {

      0%,
      100% {
        transform: translateY(0px);
      }

      50% {
        transform: translateY(-10px);
      }
    }

    /* Empty state title */
    .empty-state-title {
      font-size: 24px;
      font-weight: 700;
      color: var(--text);
      margin-bottom: 12px;
      line-height: 1.3;
    }

    /* Empty state message */
    .empty-state-message {
      font-size: 15px;
      color: var(--muted);
      line-height: 1.6;
      margin-bottom: 28px;
    }

    /* Empty state actions */
    .empty-state-actions {
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .empty-state-actions button {
      min-width: 140px;
      padding: 12px 24px;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.2s ease;
    }

    .empty-state-actions button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(77, 163, 255, 0.3);
    }

    /* ========== PHASE 4.4: Recipe Card Visual Icons ========== */
    .recipe-icon {
      position: absolute;
      left: 40px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 32px;
      line-height: 1;
      opacity: 0.9;
      transition: all 0.2s ease;
      pointer-events: none;
    }

    .item.recipe-card-wrapper:hover .recipe-icon {
      transform: translateY(-50%) scale(1.1);
      opacity: 1;
    }

    /* ========== PHASE 4.5: Subtle Animations & Transitions ========== */

    /* Respect user's motion preferences */
    @media (prefers-reduced-motion: reduce) {

      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }

      /* Disable floating animation for empty state icons */
      .empty-state-icon {
        animation: none !important;
      }
    }

    /* Card entry animation (staggered for lists) */
    .item {
      animation: slideInUp 0.4s ease-out backwards;
    }

    .item:nth-child(1) {
      animation-delay: 0.00s;
    }

    .item:nth-child(2) {
      animation-delay: 0.05s;
    }

    .item:nth-child(3) {
      animation-delay: 0.10s;
    }

    .item:nth-child(4) {
      animation-delay: 0.15s;
    }

    .item:nth-child(5) {
      animation-delay: 0.20s;
    }

    /* After 5 items, stop staggering to avoid delay on large lists */

    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Button press feedback */
    button:active:not(:disabled):not(.loading) {
      transform: scale(0.98);
      transition: transform 0.1s ease;
    }

    /* Card hover lift */
    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.4);
      transition: all 0.3s ease;
    }

    /* Tab switch fade-in */
    .grid {
      animation: fadeIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    /* Smooth modal entrance */
    .modalBack {
      animation: fadeIn 0.2s ease-out;
    }

    .modal {
      animation: modalSlideIn 0.3s ease-out;
    }

    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: translateY(-30px) scale(0.95);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    /* Success flash for positive actions */
    @keyframes successFlash {

      0%,
      100% {
        background: var(--card);
      }

      50% {
        background: rgba(16, 185, 129, 0.2);
      }
    }

    /* Toast slide-in animation (already defined, but ensuring consistency) */
    .toast {
      animation: slideIn 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    /* Pulse animation for loading indicators */
    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: 0.5;
      }
    }

    /* Smooth transitions for all interactive elements */
    .tab,
    .pill,
    .filter-chip,
    button:not(.loading),
    input,
    select,
    textarea {
      transition: all 0.2s ease;
    }

    /* Item hover effects (enhanced) */
    .item:hover {
      transform: translateX(2px);
      box-shadow: -3px 0 0 0 var(--accent);
      transition: all 0.2s ease;
    }

    /* Context menu entrance */
    .context-menu.visible {
      animation: contextMenuSlide 0.2s ease-out;
    }

    @keyframes contextMenuSlide {
      from {
        opacity: 0;
        transform: translateY(-10px) scale(0.95);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    /* ============= PHASE 5.1: COMMAND PALETTE ============= */

    /* Command palette modal backdrop */
    #commandPaletteBack {
      z-index: 120;
    }

    /* Command palette container */
    .command-palette {
      width: min(640px, 90vw);
      background: var(--card);
      border: 1px solid rgba(77, 163, 255, 0.3);
      border-radius: 16px;
      box-shadow: 0 24px 48px rgba(0, 0, 0, 0.5);
      overflow: hidden;
      animation: commandPaletteEnter 0.2s ease-out;
    }

    @keyframes commandPaletteEnter {
      from {
        opacity: 0;
        transform: scale(0.95) translateY(-20px);
      }

      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }

    /* Input wrapper */
    .command-palette-input-wrapper {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px 20px;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(135deg, rgba(77, 163, 255, 0.08) 0%, rgba(77, 163, 255, 0.03) 100%);
    }

    .command-palette-icon {
      font-size: 20px;
      color: var(--accent);
      opacity: 0.8;
    }

    #commandPaletteInput {
      flex: 1;
      background: transparent;
      border: none;
      font-size: 16px;
      color: var(--text);
      outline: none;
      padding: 0;
      min-height: auto;
    }

    #commandPaletteInput::placeholder {
      color: var(--muted);
    }

    .command-palette-hint {
      font-size: 12px;
      color: var(--muted);
      opacity: 0.7;
    }

    /* Results area */
    .command-palette-results {
      max-height: 400px;
      overflow-y: auto;
      padding: 8px 0;
    }

    /* Command category header */
    .command-category {
      font-size: 11px;
      font-weight: 600;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      padding: 12px 20px 6px 20px;
      margin-top: 8px;
    }

    .command-category:first-child {
      margin-top: 0;
    }

    /* Command item */
    .command-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 20px;
      cursor: pointer;
      transition: all 0.15s ease;
      border-left: 3px solid transparent;
    }

    .command-item:hover {
      background: rgba(77, 163, 255, 0.1);
      border-left-color: var(--accent);
    }

    .command-item.selected {
      background: rgba(77, 163, 255, 0.15);
      border-left-color: var(--accent);
    }

    .command-item-content {
      display: flex;
      align-items: center;
      gap: 12px;
      flex: 1;
    }

    .command-item-icon {
      font-size: 18px;
      width: 24px;
      text-align: center;
    }

    .command-item-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .command-item-title {
      font-size: 14px;
      font-weight: 500;
      color: var(--text);
    }

    .command-item-description {
      font-size: 12px;
      color: var(--muted);
    }

    .command-item-shortcut {
      display: flex;
      gap: 4px;
      align-items: center;
    }

    .command-item-shortcut kbd {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 4px;
      padding: 3px 6px;
      font-size: 11px;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color: var(--muted);
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    /* Empty state */
    .command-palette-empty {
      text-align: center;
      padding: 40px 20px;
      color: var(--muted);
    }

    .command-palette-empty-icon {
      font-size: 48px;
      opacity: 0.5;
      margin-bottom: 12px;
    }

    .command-palette-empty-text {
      font-size: 14px;
    }

    /* Footer */
    .command-palette-footer {
      padding: 12px 20px;
      border-top: 1px solid var(--line);
      background: rgba(255, 255, 255, 0.02);
    }

    .command-palette-footer-hint {
      font-size: 11px;
      color: var(--muted);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .command-palette-footer-hint kbd {
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.12);
      border-radius: 3px;
      padding: 2px 5px;
      font-size: 10px;
    }

    /* Scrollbar styling for results */
    .command-palette-results::-webkit-scrollbar {
      width: 8px;
    }

    .command-palette-results::-webkit-scrollbar-track {
      background: transparent;
    }

    .command-palette-results::-webkit-scrollbar-thumb {
      background: rgba(77, 163, 255, 0.3);
      border-radius: 4px;
    }

    .command-palette-results::-webkit-scrollbar-thumb:hover {
      background: rgba(77, 163, 255, 0.5);
    }

    /* ============= PHASE 5.2: RECIPE TEMPLATES ============= */

    /* Template grid layout */
    .template-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 16px;
      margin-top: 16px;
    }

    /* Template card */
    .template-card {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 20px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .template-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--accent) 0%, rgba(77, 163, 255, 0.3) 100%);
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .template-card:hover {
      background: rgba(77, 163, 255, 0.1);
      border-color: var(--accent);
      transform: translateY(-4px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
    }

    .template-card:hover::before {
      opacity: 1;
    }

    .template-card:active {
      transform: translateY(-2px);
    }

    /* Template card icon */
    .template-card-icon {
      font-size: 48px;
      line-height: 1;
      margin-bottom: 12px;
      animation: floatIcon 3s ease-in-out infinite;
    }

    @keyframes floatIcon {

      0%,
      100% {
        transform: translateY(0px);
      }

      50% {
        transform: translateY(-5px);
      }
    }

    /* Template card name */
    .template-card-name {
      font-size: 16px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 8px;
    }

    /* Template card description */
    .template-card-description {
      font-size: 13px;
      color: var(--muted);
      line-height: 1.4;
    }

    /* Responsive template grid */
    @media (max-width: 600px) {
      .template-grid {
        grid-template-columns: 1fr;
      }
    }

    /* ============= PHASE 5.3: SMART MEAL SUGGESTIONS ============= */

    /* Enhanced empty slots with suggestions button */
    .grid-empty-slot-content {
      display: flex;
      flex-direction: column;
      gap: 8px;
      align-items: center;
      padding: 4px;
    }

    .grid-empty-slot-label {
      font-size: 11px;
      color: var(--muted);
    }

    .grid-empty-suggestions-btn {
      padding: 4px 10px;
      font-size: 11px;
      background: rgba(77, 163, 255, 0.15);
      border: 1px solid rgba(77, 163, 255, 0.3);
      border-radius: 6px;
      color: var(--accent);
      cursor: pointer;
      transition: all 0.2s ease;
      white-space: nowrap;
      font-weight: 500;
    }

    .grid-empty-suggestions-btn:hover {
      background: rgba(77, 163, 255, 0.25);
      border-color: var(--accent);
      transform: scale(1.05);
    }

    /* Meal suggestions popover */
    .meal-suggestions-popover {
      position: fixed;
      width: 360px;
      max-width: calc(100vw - 40px);
      background: var(--card);
      border: 1px solid rgba(77, 163, 255, 0.3);
      border-radius: 12px;
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.4);
      z-index: 1000;
      animation: popoverSlideIn 0.2s ease-out;
    }

    @keyframes popoverSlideIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Popover header */
    .meal-suggestions-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 16px;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(135deg, rgba(77, 163, 255, 0.08) 0%, rgba(77, 163, 255, 0.03) 100%);
    }

    .meal-suggestions-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
    }

    .meal-suggestions-close {
      background: none;
      border: none;
      color: var(--muted);
      cursor: pointer;
      font-size: 18px;
      padding: 4px 8px;
      opacity: 0.7;
      transition: opacity 0.2s;
    }

    .meal-suggestions-close:hover {
      opacity: 1;
    }

    /* Loading state */
    .meal-suggestions-loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
      gap: 12px;
      color: var(--muted);
      font-size: 14px;
    }

    /* Empty state */
    .meal-suggestions-empty {
      text-align: center;
      padding: 32px 20px;
    }

    .meal-suggestions-empty-icon {
      font-size: 48px;
      opacity: 0.5;
      margin-bottom: 12px;
    }

    .meal-suggestions-empty-text {
      font-size: 14px;
      color: var(--text);
      margin-bottom: 6px;
    }

    .meal-suggestions-empty-hint {
      font-size: 12px;
      color: var(--muted);
    }

    /* Suggestions list */
    .meal-suggestions-list {
      max-height: 400px;
      overflow-y: auto;
      padding: 8px 0;
    }

    /* Suggestion item */
    .meal-suggestion-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      border-left: 3px solid transparent;
    }

    .meal-suggestion-item:hover {
      background: rgba(77, 163, 255, 0.1);
      border-left-color: var(--accent);
    }

    .meal-suggestion-icon {
      font-size: 32px;
      flex-shrink: 0;
      width: 40px;
      text-align: center;
    }

    .meal-suggestion-content {
      flex: 1;
      min-width: 0;
    }

    .meal-suggestion-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .meal-suggestion-meta {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 6px;
    }

    .meal-suggestion-reasons {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
    }

    .meal-suggestion-reason {
      font-size: 11px;
      padding: 3px 8px;
      background: rgba(77, 163, 255, 0.15);
      border: 1px solid rgba(77, 163, 255, 0.25);
      border-radius: 10px;
      color: var(--accent);
      white-space: nowrap;
    }

    .meal-suggestion-action {
      flex-shrink: 0;
    }

    .meal-suggestion-action button {
      min-width: 70px;
      padding: 6px 12px;
      font-size: 12px;
    }

    /* Footer */
    .meal-suggestions-footer {
      padding: 12px 16px;
      border-top: 1px solid var(--line);
      text-align: center;
    }

    .meal-suggestions-footer button {
      width: 100%;
      padding: 10px 16px;
      font-size: 13px;
    }

    /* Scrollbar for suggestions list */
    .meal-suggestions-list::-webkit-scrollbar {
      width: 6px;
    }

    .meal-suggestions-list::-webkit-scrollbar-track {
      background: transparent;
    }

    .meal-suggestions-list::-webkit-scrollbar-thumb {
      background: rgba(77, 163, 255, 0.3);
      border-radius: 3px;
    }

    .meal-suggestions-list::-webkit-scrollbar-thumb:hover {
      background: rgba(77, 163, 255, 0.5);
    }

    /* ============= PHASE 4.5: MULTI-USER SUPPORT / HOUSEHOLD MANAGEMENT ============= */

    /* User Switcher in Header */
    .user-switcher {
      position: relative;
    }

    .user-switcher-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      background: rgba(77, 163, 255, 0.15);
      border: 1px solid rgba(77, 163, 255, 0.3);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 14px;
      font-weight: 500;
      color: var(--text);
    }

    .user-switcher-btn:hover {
      background: rgba(77, 163, 255, 0.25);
      border-color: var(--accent);
    }

    .user-switcher-btn span:first-child {
      font-size: 18px;
      line-height: 1;
    }

    .user-switcher-arrow {
      font-size: 10px;
      opacity: 0.7;
      transition: transform 0.2s ease;
    }

    .user-switcher-btn.open .user-switcher-arrow {
      transform: rotate(180deg);
    }

    .user-switcher-dropdown {
      position: fixed;
      width: 280px;
      background: var(--card);
      border: 1px solid rgba(77, 163, 255, 0.3);
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
      z-index: 10000;
      animation: dropdownSlideIn 0.2s ease-out;
    }

    @keyframes dropdownSlideIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .user-switcher-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      border-bottom: 1px solid var(--line);
      font-size: 13px;
      font-weight: 600;
      color: var(--text);
    }

    .user-switcher-list {
      max-height: 300px;
      overflow-y: auto;
      padding: 8px 0;
    }

    .user-switcher-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      border-left: 3px solid transparent;
    }

    .user-switcher-item:hover {
      background: rgba(77, 163, 255, 0.1);
      border-left-color: var(--accent);
    }

    .user-switcher-item.active {
      background: rgba(77, 163, 255, 0.15);
      border-left-color: var(--accent);
    }

    .user-switcher-item-avatar {
      font-size: 24px;
      line-height: 1;
      flex-shrink: 0;
    }

    .user-switcher-item-info {
      flex: 1;
      min-width: 0;
    }

    .user-switcher-item-name {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .user-switcher-item-email {
      font-size: 12px;
      color: var(--muted);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .user-switcher-item-restrictions {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      margin-top: 4px;
    }

    .user-restriction-badge {
      font-size: 10px;
      padding: 2px 6px;
      background: rgba(255, 152, 0, 0.15);
      border: 1px solid rgba(255, 152, 0, 0.3);
      border-radius: 10px;
      color: #ff9800;
      white-space: nowrap;
    }

    .user-switcher-footer {
      padding: 8px;
      border-top: 1px solid var(--line);
    }

    /* Manage Users Modal */
    .manage-users-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 12px;
      margin-top: 16px;
    }

    .user-card {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 16px;
      text-align: center;
      transition: all 0.2s ease;
      position: relative;
    }

    .user-card:hover {
      background: rgba(77, 163, 255, 0.1);
      border-color: var(--accent);
      transform: translateY(-2px);
    }

    .user-card-avatar {
      font-size: 48px;
      line-height: 1;
      margin-bottom: 12px;
    }

    .user-card-name {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 6px;
    }

    .user-card-email {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 12px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .user-card-restrictions {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      justify-content: center;
      margin-bottom: 12px;
      min-height: 24px;
    }

    .user-card-actions {
      display: flex;
      gap: 6px;
      justify-content: center;
    }

    .user-card-actions button {
      flex: 1;
      padding: 6px 10px;
      font-size: 12px;
    }

    .add-user-card {
      background: rgba(77, 163, 255, 0.08);
      border: 2px dashed rgba(77, 163, 255, 0.3);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      min-height: 200px;
    }

    .add-user-card:hover {
      background: rgba(77, 163, 255, 0.15);
      border-color: var(--accent);
    }

    .add-user-card-icon {
      font-size: 48px;
      line-height: 1;
      margin-bottom: 12px;
      opacity: 0.7;
    }

    .add-user-card-text {
      font-size: 14px;
      font-weight: 600;
      color: var(--accent);
    }

    /* User Profile Editor Modal */
    .profile-editor-section {
      margin-bottom: 20px;
    }

    .profile-editor-section:last-child {
      margin-bottom: 0;
    }

    .profile-editor-section-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .profile-editor-section-title::before {
      content: '';
      width: 3px;
      height: 16px;
      background: var(--accent);
      border-radius: 2px;
    }

    .emoji-picker-grid {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 6px;
      max-height: 200px;
      overflow-y: auto;
      padding: 8px;
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid var(--line);
      border-radius: 8px;
    }

    .emoji-option {
      font-size: 32px;
      line-height: 1;
      padding: 8px;
      cursor: pointer;
      text-align: center;
      border-radius: 6px;
      transition: all 0.2s ease;
    }

    .emoji-option:hover {
      background: rgba(77, 163, 255, 0.15);
      transform: scale(1.1);
    }

    .emoji-option.selected {
      background: rgba(77, 163, 255, 0.25);
      border: 2px solid var(--accent);
    }

    .dietary-restrictions-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 10px;
    }

    .dietary-restriction-option {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 12px;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      margin: 0;
    }

    .dietary-restriction-option:hover {
      background: rgba(255, 152, 0, 0.08);
      border-color: rgba(255, 152, 0, 0.3);
    }

    .dietary-restriction-option input[type="checkbox"] {
      width: 18px;
      height: 18px;
      min-height: 18px;
      margin-top: 2px;
      cursor: pointer;
      accent-color: #ff9800;
      flex-shrink: 0;
    }

    .dietary-restriction-content {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .dietary-restriction-name {
      font-size: 14px;
      color: var(--text);
      font-weight: 500;
      user-select: none;
    }

    .dietary-restriction-desc {
      font-size: 12px;
      color: var(--muted);
      user-select: none;
    }

    .dietary-restriction-option input[type="checkbox"]:checked~.dietary-restriction-content .dietary-restriction-name {
      color: #ff9800;
      font-weight: 600;
    }

    /* Meal Assignment UI (in planner) */
    .meal-assignment-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 3px 8px;
      background: rgba(77, 163, 255, 0.15);
      border: 1px solid rgba(77, 163, 255, 0.3);
      border-radius: 10px;
      font-size: 11px;
      color: var(--accent);
      margin-right: 6px;
      margin-top: 4px;
    }

    .meal-assignment-avatar {
      font-size: 14px;
      line-height: 1;
    }

    .meal-assignment-editor {
      margin-top: 12px;
      padding: 12px;
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid var(--line);
      border-radius: 8px;
    }

    .meal-assignment-editor-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 10px;
    }

    .meal-assignment-users {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .meal-assignment-user-chip {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--line);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      user-select: none;
    }

    .meal-assignment-user-chip:hover {
      background: rgba(77, 163, 255, 0.1);
      border-color: var(--accent);
    }

    .meal-assignment-user-chip.selected {
      background: rgba(77, 163, 255, 0.2);
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(77, 163, 255, 0.3);
    }

    .meal-assignment-user-avatar {
      font-size: 18px;
      line-height: 1;
    }

    .meal-assignment-user-name {
      font-size: 13px;
      font-weight: 500;
      color: var(--text);
    }

    /* ============= PHASE 4.5.5: MEAL ASSIGNMENT UI ============= */

    /* Meal assignment editor (in meal picker modal) */
    .meal-assignment-editor {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      padding: 12px;
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid var(--line);
      border-radius: 8px;
      min-height: 48px;
    }

    /* User selection chips */
    .meal-assignment-chip {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 14px;
      background: rgba(255, 255, 255, 0.04);
      border: 2px solid var(--line);
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.2s ease;
      user-select: none;
    }

    .meal-assignment-chip:hover {
      background: rgba(77, 163, 255, 0.1);
      border-color: rgba(77, 163, 255, 0.3);
      transform: translateY(-1px);
    }

    .meal-assignment-chip.selected {
      background: linear-gradient(135deg, rgba(77, 163, 255, 0.25) 0%, rgba(77, 163, 255, 0.15) 100%);
      border-color: var(--accent);
      box-shadow: 0 2px 8px rgba(77, 163, 255, 0.3);
    }

    .meal-assignment-chip-avatar {
      font-size: 20px;
      line-height: 1;
    }

    .meal-assignment-chip-name {
      font-size: 14px;
      font-weight: 500;
      color: var(--text);
    }

    .meal-assignment-chip.selected .meal-assignment-chip-name {
      color: var(--accent);
      font-weight: 600;
    }

    .meal-assignment-chip-check {
      font-size: 14px;
      color: var(--accent);
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .meal-assignment-chip.selected .meal-assignment-chip-check {
      opacity: 1;
    }

    /* Assignment badges in planner views */
    .meal-assignment-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 8px;
      background: rgba(77, 163, 255, 0.15);
      border: 1px solid rgba(77, 163, 255, 0.3);
      border-radius: 12px;
      font-size: 11px;
      margin-top: 6px;
    }

    .meal-assignment-badge-label {
      font-weight: 600;
      color: var(--muted);
    }

    .meal-assignment-badge-avatars {
      display: flex;
      align-items: center;
      gap: 2px;
    }

    .meal-assignment-badge-avatar {
      font-size: 14px;
      line-height: 1;
    }

    .meal-assignment-badge-names {
      font-size: 11px;
      color: var(--text);
      font-weight: 500;
    }

    /* Grid view assignment avatars */
    .grid-meal-assignments {
      position: absolute;
      bottom: 4px;
      left: 4px;
      display: flex;
      gap: 2px;
      z-index: 2;
    }

    .grid-assignment-avatar {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: var(--card);
      border: 1px solid rgba(77, 163, 255, 0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
    }


    /* ==================== HOME DASHBOARD STYLES ==================== */
    .dashboard-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 20px;
    }

    @media (min-width: 900px) {
      .dashboard-grid {
        grid-template-columns: 2fr 1fr;
      }
    }

    /* Week Overview Mini Calendar */
    .dashboard-week-overview {
      margin-top: 20px;
    }

    .week-overview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .week-overview-header h3 {
      margin: 0;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .week-overview-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 8px;
    }

    .week-day-cell {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid var(--glass-border);
      border-radius: 12px;
      padding: 10px 8px;
      text-align: center;
      cursor: pointer;
      transition: all var(--transition-fast);
      min-height: 90px;
      display: flex;
      flex-direction: column;
    }

    .week-day-cell:hover {
      background: rgba(255, 255, 255, 0.06);
      border-color: var(--accent);
      transform: translateY(-2px);
    }

    .week-day-cell.today {
      background: rgba(16, 185, 129, 0.1);
      border-color: var(--accent);
    }

    .week-day-cell.today .week-day-name {
      color: var(--accent);
    }

    .week-day-name {
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--muted);
      margin-bottom: 4px;
    }

    .week-day-date {
      font-size: 18px;
      font-weight: 700;
      color: var(--text);
      margin-bottom: 8px;
    }

    .week-day-meals {
      display: flex;
      flex-direction: column;
      gap: 3px;
      flex: 1;
    }

    .week-meal-dot {
      width: 100%;
      height: 4px;
      border-radius: 2px;
      opacity: 0.8;
    }

    .week-meal-dot.breakfast {
      background: var(--accent-secondary);
    }

    .week-meal-dot.lunch {
      background: var(--accent);
    }

    .week-meal-dot.dinner {
      background: var(--accent-deep);
    }

    .week-meal-dot.empty {
      background: rgba(255, 255, 255, 0.1);
    }

    .week-meal-pill {
      font-size: 9px;
      font-weight: 600;
      padding: 3px 6px;
      border-radius: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      text-align: center;
    }

    .week-meal-pill.breakfast {
      background: rgba(251, 191, 36, 0.2);
      color: var(--accent-secondary);
    }

    .week-meal-pill.lunch {
      background: rgba(16, 185, 129, 0.2);
      color: var(--accent);
    }

    .week-meal-pill.dinner {
      background: rgba(139, 92, 246, 0.2);
      color: var(--accent-deep);
    }

    .week-day-empty {
      font-size: 9px;
      color: var(--muted);
      opacity: 0.5;
      text-align: center;
      padding: 4px;
    }

    /* Upcoming Meals Card */
    .dashboard-upcoming h3 {
      margin: 0 0 16px 0;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .upcoming-meals-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .upcoming-meal-item {
      display: flex;
      gap: 12px;
      padding: 12px;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 10px;
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .upcoming-meal-item:hover {
      background: rgba(255, 255, 255, 0.06);
      transform: translateX(4px);
    }

    .upcoming-meal-time {
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 50px;
      padding-right: 12px;
      border-right: 1px solid var(--glass-border);
    }

    .upcoming-meal-day {
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      color: var(--muted);
    }

    .upcoming-meal-slot {
      font-size: 10px;
      font-weight: 600;
      padding: 2px 6px;
      border-radius: 4px;
      margin-top: 4px;
    }

    .upcoming-meal-slot.breakfast {
      background: rgba(251, 191, 36, 0.2);
      color: var(--accent-secondary);
    }

    .upcoming-meal-slot.lunch {
      background: rgba(16, 185, 129, 0.2);
      color: var(--accent);
    }

    .upcoming-meal-slot.dinner {
      background: rgba(139, 92, 246, 0.2);
      color: var(--accent-deep);
    }

    .upcoming-meal-info {
      flex: 1;
      min-width: 0;
    }

    .upcoming-meal-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .upcoming-meal-meta {
      font-size: 12px;
      color: var(--muted);
      margin-top: 2px;
    }

    .upcoming-empty {
      text-align: center;
      padding: 20px;
      color: var(--muted);
      font-size: 13px;
    }

    /* Recent Activity Card */
    .dashboard-activity h3 {
      margin: 0 0 16px 0;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .recent-activity-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      max-height: 200px;
      overflow-y: auto;
    }

    .activity-item {
      display: flex;
      gap: 10px;
      padding: 8px 10px;
      background: rgba(255, 255, 255, 0.02);
      border-radius: 8px;
      font-size: 13px;
      align-items: flex-start;
    }

    .activity-icon {
      width: 28px;
      height: 28px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      font-size: 14px;
    }

    .activity-icon.add {
      background: rgba(16, 185, 129, 0.15);
      color: var(--accent);
    }

    .activity-icon.edit {
      background: rgba(59, 130, 246, 0.15);
      color: #3b82f6;
    }

    .activity-icon.delete {
      background: rgba(239, 68, 68, 0.15);
      color: #ef4444;
    }

    .activity-icon.plan {
      background: rgba(139, 92, 246, 0.15);
      color: var(--accent-deep);
    }

    .activity-content {
      flex: 1;
      min-width: 0;
    }

    .activity-text {
      color: var(--text);
      line-height: 1.4;
    }

    .activity-time {
      font-size: 11px;
      color: var(--muted);
      margin-top: 2px;
    }

    .activity-empty {
      text-align: center;
      padding: 20px;
      color: var(--muted);
      font-size: 13px;
    }

    /* ============================================
       DAY DETAIL MODAL
       ============================================ */
    .day-detail-content {
      padding: 16px 0;
    }

    .day-detail-slot {
      margin-bottom: 20px;
    }

    .day-detail-slot:last-child {
      margin-bottom: 0;
    }

    .day-detail-slot-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--glass-border);
    }

    .day-detail-slot-title {
      font-size: 14px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .day-detail-slot-title.breakfast {
      color: var(--accent-secondary);
    }

    .day-detail-slot-title.lunch {
      color: var(--accent);
    }

    .day-detail-slot-title.dinner {
      color: var(--accent-deep);
    }

    .day-detail-meals {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .day-detail-meal-card {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid var(--glass-border);
      border-radius: 10px;
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .day-detail-meal-card:hover {
      background: rgba(255, 255, 255, 0.06);
      border-color: var(--accent);
      transform: translateX(4px);
    }

    .day-detail-meal-image {
      width: 60px;
      height: 60px;
      border-radius: 8px;
      object-fit: cover;
      flex-shrink: 0;
      background: var(--card);
    }

    .day-detail-meal-info {
      flex: 1;
      min-width: 0;
    }

    .day-detail-meal-title {
      font-size: 15px;
      font-weight: 600;
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .day-detail-meal-meta {
      font-size: 12px;
      color: var(--muted);
      margin-top: 4px;
    }

    .day-detail-meal-actions {
      display: flex;
      gap: 6px;
      flex-shrink: 0;
    }

    .day-detail-meal-actions button {
      padding: 6px 10px;
      font-size: 12px;
    }

    .day-detail-empty {
      padding: 16px;
      text-align: center;
      color: var(--muted);
      font-size: 13px;
      background: rgba(255, 255, 255, 0.02);
      border-radius: 8px;
      border: 1px dashed var(--glass-border);
    }

    .day-detail-add-btn {
      width: 100%;
      justify-content: center;
      margin-top: 8px;
      border-style: dashed;
    }

    /* Day Detail Modal - Planner View Styles */
    .day-detail-planner-view {
      padding: 0 !important;
    }

    .day-detail-planner-view .planner-grid {
      display: block;
    }

    .day-detail-planner-view .planner-day-card {
      background: transparent;
      border: none;
      padding: 0;
      animation: none;
    }

    .day-detail-planner-view .planner-day-header {
      display: none;
      /* Hide header since we have the modal title */
    }

    .day-detail-planner-view .planner-slot {
      margin-bottom: 20px;
      padding: 16px;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid var(--glass-border);
      border-radius: 12px;
    }

    .day-detail-planner-view .planner-slot:last-child {
      margin-bottom: 0;
    }

    .day-detail-planner-view .slot-label {
      font-size: 14px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 12px;
      display: block;
    }

    .day-detail-planner-view .slot-breakfast .slot-label {
      color: var(--accent-secondary);
    }

    .day-detail-planner-view .slot-lunch .slot-label {
      color: var(--accent);
    }

    .day-detail-planner-view .slot-dinner .slot-label {
      color: var(--accent-deep);
    }

    .day-detail-planner-view .meal-line {
      padding: 12px;
      background: rgba(255, 255, 255, 0.02);
      border-radius: 8px;
      margin-bottom: 8px;
    }

    .day-detail-planner-view .meal-line:last-child {
      margin-bottom: 0;
    }

    .day-detail-planner-view .meal-title {
      font-size: 15px;
      font-weight: 600;
    }

    .day-detail-planner-view .meal-actions {
      margin-top: 8px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .day-detail-planner-view .card-action-btn {
      padding: 6px 12px;
      font-size: 12px;
      border-radius: 6px;
    }

    .day-detail-planner-view .additional-items-container {
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid var(--glass-border);
    }

    .day-detail-planner-view .ghost-hover {
      cursor: pointer;
      border: 1px dashed var(--glass-border);
      border-radius: 8px;
    }

    .day-detail-planner-view .ghost-hover:hover {
      background: rgba(255, 255, 255, 0.04);
      border-color: var(--accent);
    }

    /* Stats row enhancement */
    .dashboard-stats-row {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
      margin-top: 20px;
    }

    .stat-card {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid var(--glass-border);
      border-radius: 14px;
      padding: 16px;
      display: flex;
      align-items: center;
      gap: 14px;
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .stat-card:hover {
      background: rgba(255, 255, 255, 0.06);
      border-color: var(--accent);
      transform: translateY(-2px);
    }

    .stat-icon {
      width: 44px;
      height: 44px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(16, 185, 129, 0.1);
      color: var(--accent);
    }

    .stat-value {
      font-size: 22px;
      font-weight: 700;
      color: var(--text);
    }

    .stat-label {
      font-size: 12px;
      color: var(--muted);
      margin-top: 2px;
    }

    /* Quick Actions card */
    .dashboard-sidebar .card h3 {
      margin: 0 0 16px 0;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .dashboard-sidebar .list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .dashboard-sidebar .list button {
      justify-content: flex-start;
      width: 100%;
      text-align: left;
    }

    /* Responsive adjustments */
    @media (max-width: 1100px) {
      .dashboard-stats-row {
        grid-template-columns: repeat(2, 1fr);
      }

      .week-overview-grid {
        grid-template-columns: repeat(7, 1fr);
        gap: 4px;
      }

      .week-day-cell {
        padding: 8px 4px;
        min-height: 70px;
      }

      .week-day-name {
        font-size: 9px;
      }

      .week-day-date {
        font-size: 14px;
      }
    }

    @media (max-width: 600px) {
      .dashboard-stats-row {
        grid-template-columns: 1fr 1fr;
      }

      .week-overview-grid {
        grid-template-columns: repeat(4, 1fr);
      }

      .week-day-cell:nth-child(n+5) {
        display: none;
      }
    }

    /* Hero Card - Dinner Tonight */
    /* Hero Card - Dinner Tonight */
    .dashboard-hero {
      display: grid;
      grid-template-columns: 1fr;
      gap: 20px;
      overflow: hidden;
      padding: 0;
      border: 1px solid var(--glass-border);
      background: var(--glass-bg);
      backdrop-filter: var(--glass-blur);
      border-radius: 24px;
      min-height: 280px;
      box-shadow: var(--card-shadow);
    }

    /* ==================== PREMIUM PLANNER UI ==================== */
    .planner-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 24px;
      padding: 20px 0;
    }

    .planner-day-card {
      background: var(--card);
      backdrop-filter: var(--glass-blur);
      border: 1px solid var(--glass-border);
      border-radius: 16px;
      padding: 0;
      overflow: hidden;
      box-shadow: var(--card-shadow);
    }

    .planner-day-card:hover {
      border-color: rgba(255, 255, 255, 0.2);
    }

    .planner-day-header {
      padding: 16px 20px;
      background: rgba(255, 255, 255, 0.05);
      border-bottom: 1px solid var(--glass-border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* Clear day button in header */
    .planner-day-header .card-action-btn {
      width: 28px;
      height: 28px;
      font-size: 14px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: var(--muted);
      opacity: 0.6;
      transition: all 0.2s ease;
    }

    .planner-day-header .card-action-btn:hover {
      opacity: 1;
      background: rgba(239, 68, 68, 0.2);
      border-color: rgba(239, 68, 68, 0.4);
      color: #ef4444;
    }

    .planner-day-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--text-primary);
      text-transform: capitalize;
    }

    .day-subtitle {
      font-size: 12px;
      color: var(--text-secondary);
      font-weight: 500;
    }

    .planner-slot {
      padding: 12px 16px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .planner-slot:last-of-type {
      border-bottom: none;
    }

    .slot-label {
      font-size: 11px;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: 12px;
      display: block;
      opacity: 0.7;
    }

    .slot-breakfast {
      color: var(--accent-secondary);
      border-left: 3px solid var(--accent-secondary);
    }

    .slot-lunch {
      color: var(--accent);
      border-left: 3px solid var(--accent);
    }

    .slot-dinner {
      color: var(--accent-deep);
      border-left: 3px solid var(--accent-deep);
    }

    .meal-line {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 8px;
      padding: 8px 10px;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.02);
      margin-bottom: 4px;
      cursor: pointer;
    }

    .meal-line:hover {
      background: rgba(255, 255, 255, 0.06);
    }

    .meal-title {
      flex: 1 1 auto;
      min-width: 120px;
      font-size: 14px;
      font-weight: 500;
      color: var(--text);
      word-wrap: break-word;
      line-height: 1.3;
    }

    .meal-badges {
      display: flex;
      gap: 6px;
      align-items: center;
      flex-shrink: 0;
    }

    .meal-badge {
      font-size: 10px;
      font-weight: 700;
      padding: 2px 8px;
      border-radius: 20px;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      color: var(--text-secondary);
      white-space: nowrap;
    }

    .badge-leftovers {
      background: rgba(168, 85, 247, 0.15);
      color: #a855f7;
      border-color: rgba(168, 85, 247, 0.4);
    }

    .badge-whole-family {
      background: rgba(59, 130, 246, 0.1);
      color: #60a5fa;
      border-color: rgba(59, 130, 246, 0.3);
    }

    .meal-actions {
      display: flex;
      gap: 4px;
      opacity: 1;
      /* Always visible */
    }

    /* .meal-line:hover .meal-actions { opacity: 1; } - Removed as it's now redundant */

    .meal-line .card-action-btn {
      width: 24px;
      height: 24px;
      font-size: 12px;
    }

    /* ========== SIDE DISH / ADDITIONAL ITEMS STYLING ========== */
    .additional-items-container {
      flex-basis: 100%;
      width: 100%;
      margin-top: 4px;
      padding-left: 0;
    }

    .additional-items {
      margin-top: 0;
    }

    .meal-assignment-badge-container {
      flex-shrink: 0;
    }

    /* Side dish details - collapsible section in list view */
    .side-dish-details {
      background: rgba(77, 163, 255, 0.08);
      border: 1px solid rgba(77, 163, 255, 0.2);
      border-radius: 6px;
    }

    .side-dish-details summary {
      padding: 8px 10px;
      cursor: pointer;
      font-size: 11px;
      color: var(--text-secondary);
      font-weight: 600;
      list-style: none;
      display: flex;
      align-items: center;
      gap: 6px;
      user-select: none;
    }

    .side-dish-details summary:hover {
      background: rgba(77, 163, 255, 0.12);
    }

    .side-dish-details[open] summary {
      border-bottom: 1px solid rgba(77, 163, 255, 0.15);
    }

    /* Hide native marker for side-dish-details */
    .side-dish-details summary::-webkit-details-marker {
      display: none;
    }

    .side-dish-details summary::marker {
      display: none;
    }

    /* Override global summary:before for side-dish-details - use single arrow */
    .side-dish-details summary:before {
      content: "▶";
      display: inline-block;
      font-size: 10px;
      color: var(--accent);
      transition: transform 0.2s ease;
      margin-right: 6px;
    }

    .side-dish-details[open] summary:before {
      content: "▶";
      transform: rotate(90deg);
    }

    /* Content area inside the expanded details */
    .side-dish-details>div {
      padding: 8px 10px;
    }

    /* Additional items list inside details */
    .additional-items-list {
      padding: 0;
    }

    .additional-item {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 0;
      border-bottom: 1px solid rgba(77, 163, 255, 0.08);
    }

    .additional-item:last-child {
      border-bottom: none;
    }

    .item-type-badge {
      background: var(--accent);
      color: white;
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 9px;
      text-transform: uppercase;
      font-weight: 600;
      flex-shrink: 0;
    }

    .item-title {
      flex: 1;
      font-size: 12px;
      color: var(--text);
      font-weight: 500;
      min-width: 0;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .btn-add-additional {
      padding: 4px 10px;
      background: rgba(77, 163, 255, 0.1);
      color: var(--accent);
      border: 1px solid rgba(77, 163, 255, 0.2);
      border-radius: 4px;
      cursor: pointer;
      font-size: 11px;
      font-weight: 500;
      transition: all 0.2s ease;
    }

    .btn-add-additional:hover {
      background: rgba(77, 163, 255, 0.25);
      border-color: rgba(77, 163, 255, 0.5);
    }

    /* Add margin when inside details expanded content */
    .side-dish-details .btn-add-additional {
      margin-top: 10px;
    }

    .btn-remove-additional {
      background: none;
      border: none;
      color: var(--danger);
      cursor: pointer;
      font-size: 14px;
      padding: 4px 8px;
      opacity: 0.7;
      transition: opacity 0.2s ease;
    }

    .btn-remove-additional:hover {
      opacity: 1;
    }

    /* Grid view additional items styling */
    .grid-additional-badge {
      position: absolute;
      top: 4px;
      right: 4px;
      background: var(--accent);
      color: white;
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 10px;
      font-weight: 600;
    }

    .grid-expand-btn {
      position: absolute;
      bottom: 4px;
      right: 4px;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      cursor: pointer;
      font-size: 12px;
      padding: 2px 6px;
      border-radius: 4px;
      color: var(--muted);
      transition: all 0.2s ease;
    }

    .grid-expand-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      color: var(--text);
    }

    .grid-additional-popover {
      position: absolute;
      background: var(--card-elevated);
      border: 1px solid var(--line-strong);
      border-radius: 12px;
      padding: 16px;
      min-width: 250px;
      max-width: 350px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
      z-index: 10000;
    }

    .grid-additional-popover h4 {
      margin: 0 0 12px 0;
      font-size: 14px;
      color: var(--text);
    }

    .popover-item {
      padding: 8px 0;
      display: flex;
      align-items: center;
      gap: 8px;
      border-bottom: 1px solid var(--line);
    }

    .popover-item:last-child {
      border-bottom: none;
    }

    /* Swap actions */
    .planner-actions {
      padding: 12px 20px;
      background: rgba(0, 0, 0, 0.2);
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .planner-actions button {
      flex: 1;
      min-width: 80px;
      font-size: 11px;
      padding: 6px 8px;
    }

    @media (min-width: 600px) {
      .dashboard-hero {
        grid-template-columns: 1.2fr 0.8fr;
      }
    }

    .hero-content {
      padding: 24px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .hero-label {
      text-transform: uppercase;
      font-size: 12px;
      letter-spacing: 1px;
      color: var(--accent);
      font-weight: 700;
      margin-bottom: 8px;
    }

    .hero-title {
      font-size: 38px;
      font-weight: 800;
      margin: 0 0 16px 0;
      line-height: 1.1;
      letter-spacing: -0.03em;
      background: linear-gradient(to right, #fff, var(--accent));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .hero-image {
      background-size: cover;
      background-position: center;
      min-height: 240px;
      border-left: 1px solid var(--glass-border);
      position: relative;
    }

    .hero-image::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(to right, var(--bg-elevated), transparent);
      opacity: 0.3;
    }

    .hero-actions {
      display: flex;
      gap: 12px;
      margin-top: 24px;
    }

    .hero-meta {
      display: flex;
      gap: 16px;
      font-size: 13px;
      color: var(--muted);
    }

    /* Stat Cards */
    .dashboard-stats-row {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin-top: 20px;
    }

    .stat-card {
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      padding: 20px;
      border-radius: 18px;
      display: flex;
      align-items: center;
      gap: 16px;
      cursor: pointer;
      backdrop-filter: var(--glass-blur);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .stat-card:hover {
      transform: translateY(-2px);
      border-color: var(--accent);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .stat-icon {
      font-size: 22px;
      width: 52px;
      height: 52px;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--accent);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    .stat-value {
      font-size: 24px;
      font-weight: 700;
      color: var(--text);
      line-height: 1;
    }

    .stat-label {
      font-size: 12px;
      color: var(--muted);
      margin-top: 4px;
    }

    /* Stat Card Color Variants */
    .stat-card.stat-low-stock .stat-icon {
      color: var(--warning);
      background: rgba(245, 158, 11, 0.15);
      border-color: rgba(245, 158, 11, 0.3);
    }

    .stat-card.stat-low-stock:hover {
      border-color: var(--warning);
    }

    .stat-card.stat-expiring .stat-icon {
      color: var(--danger);
      background: rgba(244, 63, 94, 0.15);
      border-color: rgba(244, 63, 94, 0.3);
    }

    .stat-card.stat-expiring:hover {
      border-color: var(--danger);
    }

    /* Empty State Styling */
    .hero-title.empty {
      -webkit-text-fill-color: var(--muted);
      font-size: 24px;
    }

    /* ==================== VISUAL IMPORT PREVIEW STYLES ==================== */
    .import-preview-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 24px;
      margin-top: 20px;
    }

    @media (min-width: 900px) {
      .import-preview-grid {
        grid-template-columns: 1fr 400px;
      }
    }

    .import-edit-form {
      border-right: none;
      padding-right: 0;
    }

    @media (min-width: 900px) {
      .import-edit-form {
        border-right: 1px solid var(--line);
        padding-right: 24px;
      }
    }

    .import-visual-preview {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .recipe-preview-card {
      width: 100%;
      max-width: 400px;
      padding: 0 !important;
      overflow: hidden;
      background: var(--card);
      border: 1px solid var(--line-strong);
    }

    .preview-card-image {
      width: 100%;
      height: 200px;
      background-size: cover;
      background-position: center;
      background-color: var(--bg-elevated);
    }

    .preview-card-content {
      padding: 20px;
    }

    #importRecipeModalBack .modal {
      width: min(1100px, 95vw);
    }

    /* ==================== PANTRY SUGGESTION STYLES ==================== */
    .pantry-suggestion-list {
      position: absolute;
      z-index: 1000;
      background: var(--card-elevated);
      border: 1px solid var(--line-strong);
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
      max-height: 200px;
      overflow-y: auto;
      width: 100%;
    }

    .pantry-suggestion-item {
      padding: 8px 12px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid var(--line-subtle);
      font-size: 13px;
    }

    .pantry-suggestion-item:last-child {
      border-bottom: none;
    }

    .pantry-suggestion-item:hover,
    .pantry-suggestion-item.active {
      background: var(--card-hover);
      color: var(--accent);
    }

    .pantry-stock-badge {
      font-size: 11px;
      padding: 2px 6px;
      border-radius: 4px;
    }

    .pantry-stock-low {
      background: rgba(245, 158, 11, 0.2);
      color: var(--warning);
    }

    .pantry-stock-ok {
      background: rgba(16, 185, 129, 0.2);
      color: var(--success);
    }

    /* ==================== GLOBAL MICRO-ANIMATIONS ==================== */
    button,
    .tab,
    .stat-card,
    .recipe-card,
    .nav-item,
    .card,
    .btn {
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }

    button:active,
    .tab:active,
    .stat-card:active,
    .btn:active {
      transform: scale(0.98);
    }

    .glass-hover:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    @keyframes fadeInScale {
      from {
        opacity: 0;
        transform: scale(0.95) translateY(10px);
      }

      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }

    .animate-in {
      animation: fadeInScale 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }

    /* Fluid Modals */
    .modal {
      transform-origin: center center;
      /* Will be overridden in JS */
      transition: opacity 0.3s ease, transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .modalBack.show {
      display: flex;
      animation: fadeIn 0.3s ease forwards;
    }

    .modalBack.show .modal {
      animation: modalPop 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }

    @keyframes modalPop {
      from {
        opacity: 0;
        transform: scale(0.8) translateY(20px);
      }

      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }

    @keyframes toastIn {
      from {
        opacity: 0;
        transform: translateX(40px) scale(0.9);
      }

      to {
        opacity: 1;
        transform: translateX(0) scale(1);
      }
    }

    /* Haptic Feedback Pulse */
    @keyframes hapticPulse {
      0% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4);
      }

      50% {
        transform: scale(1.02);
        box-shadow: 0 0 0 10px rgba(16, 185, 129, 0);
      }

      100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);
      }
    }

    .success-pulse {
      animation: hapticPulse 0.4s ease-out;
    }

    /* Loading Shimmer Animation */
    @keyframes skeleton-loading {
      0% {
        background-position: 100% 50%;
      }

      100% {
        background-position: 0% 50%;
      }
    }

    /* Accent glow for primary buttons */
    .btn-primary:hover {
      box-shadow: 0 0 20px rgba(16, 185, 129, 0.4);
      transform: translateY(-2px);
    }

    /* ============= RESPONSIVE HEADER FIX ============= */
    @media (max-width: 900px) {
      header h1 {
        font-size: 18px;
      }

      header .muted {
        font-size: 11px;
      }

      .tabs .tab {
        font-size: 11px;
        padding: 5px 6px;
      }
    }

    @media (max-width: 700px) {
      header {
        padding: 12px 16px;
      }

      header h1 {
        font-size: 16px;
      }

      header .muted {
        display: none;
        /* Hide subtitle on small screens */
      }

      .tabs .tab {
        font-size: 10px;
        padding: 4px 5px;
      }

      #btnUserSwitcher {
        font-size: 10px !important;
        padding: 4px 6px !important;
      }

      #btnThemeToggle,
      #companionFloatBtn,
      #contextualHelpBtn,
      #btnStartTour,
      #recentActionsFloatBtn {
        font-size: 12px !important;
        padding: 4px 6px !important;
      }
    }

    @media (max-width: 500px) {
      header h1 {
        font-size: 14px;
      }

      .tabs .tab {
        font-size: 9px;
        padding: 3px 4px;
      }

      /* Hide some buttons on very small screens */
      #recentActionsFloatBtn,
      #companionFloatBtn {
        display: none;
      }

      /* Smaller cards on very small screens */
      .card {
        padding: 12px;
        border-radius: 12px;
      }

      /* Recipe grid on small screens */
      .recipe-grid {
        grid-template-columns: 1fr;
        gap: 16px;
        padding: 16px 0;
      }

      .recipe-card {
        height: 280px;
      }

      /* Modals take full width on small screens */
      .modal {
        width: 100%;
        max-width: 100%;
        margin: 8px;
        max-height: calc(100vh - 16px);
        border-radius: 12px;
      }

      /* Toast notification adjustments */
      #toast-container {
        left: 8px;
        right: 8px;
        top: 100px;
      }

      .toast {
        min-width: auto;
        max-width: 100%;
      }
    }

    /* Tablet-ish screens (600-900px) */
    @media (min-width: 501px) and (max-width: 900px) {
      .recipe-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .dashboard-grid {
        grid-template-columns: 1fr;
      }

      .dashboard-sidebar {
        grid-column: span 1;
      }
    }

    /* ============= PHASE 9: GLOBAL UI PORTALS (Fixed Z-Index) ============= */
    .global-tooltip {
      position: fixed;
      padding: 12px 16px;
      background: #111827;
      /* Solid dark background like companion panel */
      color: var(--text);
      border: 1px solid var(--line);
      border-radius: 12px;
      font-size: 13px;
      pointer-events: none;
      z-index: 100000;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
      display: none;
      max-width: 300px;
      white-space: nowrap;
      backdrop-filter: blur(12px);
      /* Glass effect if supported/transparent */
    }

    .global-dropdown-menu {
      position: fixed;
      background: var(--card-elevated);
      border: 1px solid var(--line-strong);
      border-radius: 12px;
      padding: 6px;
      min-width: 180px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      z-index: 10001;
      display: flex;
      flex-direction: column;
      gap: 2px;
      backdrop-filter: var(--glass-blur);
    }

    .modal-card {
      background: var(--card-elevated);
      border: 1px solid var(--glass-border);
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
      backdrop-filter: var(--glass-blur);
      color: var(--text);
      display: flex;
      flex-direction: column;
    }

    .modal-card h3 {
      color: var(--text);
    }

    .modal-card label {
      color: var(--text-secondary);
    }

    .modal-card input,
    .modal-card select {
      background: var(--bg-darker);
      border: 1px solid var(--line);
      color: var(--text);
    }

    .global-dropdown-option {
      display: block;
      width: 100%;
      padding: 10px 14px;
      border: none;
      background: none;
      text-align: left;
      cursor: pointer;
      color: var(--text);
      font-size: 13px;
      transition: background 0.2s;
    }

    .global-dropdown-option:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    /* ========== PHASE 5: VISUAL POLISH ========== */

    /* Focus States - Accessibility */
    :focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    button:focus-visible,
    input:focus-visible,
    select:focus-visible,
    textarea:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
      box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.15);
    }

    /* Skip to content (accessibility) */
    .skip-link {
      position: absolute;
      top: -40px;
      left: 0;
      background: var(--accent);
      color: white;
      padding: 8px 16px;
      z-index: 10000;
      transition: top 0.2s;
    }

    .skip-link:focus {
      top: 0;
    }

    /* Enhanced Input Styling */
    input,
    select,
    textarea {
      transition: border-color var(--transition-fast),
        box-shadow var(--transition-fast),
        background var(--transition-fast);
    }

    input:hover:not(:disabled):not(:focus),
    select:hover:not(:disabled):not(:focus),
    textarea:hover:not(:disabled):not(:focus) {
      border-color: var(--line-strong);
    }

    input::placeholder,
    textarea::placeholder {
      color: var(--text-muted);
      opacity: 0.7;
    }

    /* Selection Color */
    ::selection {
      background: var(--selection);
      color: var(--text);
    }

    /* Scrollbar Styling */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.15);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.25);
    }

    /* Smooth scrolling */
    html {
      scroll-behavior: smooth;
    }

    @media (prefers-reduced-motion: reduce) {
      html {
        scroll-behavior: auto;
      }

      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* Loading Skeleton Animation */
    .skeleton {
      background: linear-gradient(90deg,
          var(--glass-bg) 0%,
          rgba(255, 255, 255, 0.08) 50%,
          var(--glass-bg) 100%);
      background-size: 200% 100%;
      animation: skeleton-shimmer 1.5s ease-in-out infinite;
      border-radius: 8px;
    }

    @keyframes skeleton-shimmer {
      0% {
        background-position: 200% 0;
      }

      100% {
        background-position: -200% 0;
      }
    }

    .skeleton-text {
      height: 16px;
      margin-bottom: 8px;
    }

    .skeleton-text.short {
      width: 60%;
    }

    .skeleton-image {
      aspect-ratio: 16/9;
    }

    /* Pulse animation for notifications */
    @keyframes pulse-ring {
      0% {
        transform: scale(0.8);
        opacity: 1;
      }

      100% {
        transform: scale(1.5);
        opacity: 0;
      }
    }

    .pulse-indicator {
      position: relative;
    }

    .pulse-indicator::after {
      content: '';
      position: absolute;
      inset: -4px;
      border-radius: 50%;
      background: var(--accent);
      opacity: 0;
      animation: pulse-ring 1.5s ease-out infinite;
    }

    /* Badge Improvements */
    .badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 2px 8px;
      font-size: 11px;
      font-weight: 600;
      border-radius: 12px;
      text-transform: uppercase;
      letter-spacing: 0.03em;
    }

    .badge-success {
      background: rgba(16, 185, 129, 0.15);
      color: var(--success);
      border: 1px solid rgba(16, 185, 129, 0.3);
    }

    .badge-warning {
      background: rgba(245, 158, 11, 0.15);
      color: var(--warning);
      border: 1px solid rgba(245, 158, 11, 0.3);
    }

    .badge-danger {
      background: rgba(244, 63, 94, 0.15);
      color: var(--danger);
      border: 1px solid rgba(244, 63, 94, 0.3);
    }

    .badge-info {
      background: rgba(59, 130, 246, 0.15);
      color: var(--info);
      border: 1px solid rgba(59, 130, 246, 0.3);
    }

    /* Empty State Styling */
    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 48px 24px;
      text-align: center;
      color: var(--muted);
    }

    .empty-state-icon {
      width: 64px;
      height: 64px;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    .empty-state-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 8px;
    }

    .empty-state-description {
      font-size: 14px;
      max-width: 320px;
      line-height: 1.5;
    }

    .empty-state-action {
      margin-top: 20px;
    }

    /* Divider Improvements */
    .divider {
      height: 1px;
      background: linear-gradient(90deg,
          transparent,
          var(--glass-border) 20%,
          var(--glass-border) 80%,
          transparent);
      margin: 16px 0;
    }

    .divider-text {
      display: flex;
      align-items: center;
      gap: 16px;
      color: var(--muted);
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .divider-text::before,
    .divider-text::after {
      content: '';
      flex: 1;
      height: 1px;
      background: var(--glass-border);
    }

    /* Improved Checkbox/Radio Styling */
    input[type="checkbox"]:not(.shopping-item-checkbox):not(.large-checkbox),
    input[type="radio"]:not(.large-radio) {
      appearance: none;
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      min-width: 18px;
      min-height: 18px;
      border: 2px solid var(--line-strong);
      border-radius: 4px;
      background: var(--glass-bg);
      cursor: pointer;
      transition: all var(--transition-fast);
      position: relative;
      flex-shrink: 0;
    }

    input[type="radio"]:not(.large-radio) {
      border-radius: 50%;
    }

    input[type="checkbox"]:not(.shopping-item-checkbox):not(.large-checkbox):hover,
    input[type="radio"]:not(.large-radio):hover {
      border-color: var(--accent);
      background: rgba(16, 185, 129, 0.1);
    }

    input[type="checkbox"]:not(.shopping-item-checkbox):not(.large-checkbox):checked,
    input[type="radio"]:not(.large-radio):checked {
      background: var(--accent);
      border-color: var(--accent);
    }

    input[type="checkbox"]:not(.shopping-item-checkbox):not(.large-checkbox):checked::after {
      content: '';
      position: absolute;
      left: 5px;
      top: 2px;
      width: 4px;
      height: 8px;
      border: solid white;
      border-width: 0 2px 2px 0;
      transform: rotate(45deg);
    }

    input[type="radio"]:not(.large-radio):checked::after {
      content: '';
      position: absolute;
      left: 4px;
      top: 4px;
      width: 6px;
      height: 6px;
      background: white;
      border-radius: 50%;
    }

    /* Large checkbox variant for shopping list etc */
    input[type="checkbox"].large-checkbox,
    input[type="checkbox"].shopping-item-checkbox {
      appearance: none;
      -webkit-appearance: none;
      width: 24px;
      height: 24px;
      min-width: 24px;
      min-height: 24px;
      border: 2px solid var(--line-strong);
      border-radius: 4px;
      background: var(--glass-bg);
      cursor: pointer;
      transition: all var(--transition-fast);
      position: relative;
      flex-shrink: 0;
    }

    input[type="checkbox"].large-checkbox:hover,
    input[type="checkbox"].shopping-item-checkbox:hover {
      border-color: var(--accent);
      background: rgba(16, 185, 129, 0.1);
    }

    input[type="checkbox"].large-checkbox:checked,
    input[type="checkbox"].shopping-item-checkbox:checked {
      background: var(--accent);
      border-color: var(--accent);
    }

    input[type="checkbox"].large-checkbox:checked::after,
    input[type="checkbox"].shopping-item-checkbox:checked::after {
      content: '';
      position: absolute;
      left: 7px;
      top: 3px;
      width: 6px;
      height: 12px;
      border: solid white;
      border-width: 0 3px 3px 0;
      transform: rotate(45deg);
    }

    /* Tooltip improvements */
    [data-tooltip] {
      position: relative;
    }

    /* Progress Bar */
    .progress-bar {
      height: 6px;
      background: var(--glass-bg);
      border-radius: 3px;
      overflow: hidden;
    }

    .progress-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent), var(--accent-secondary));
      border-radius: 3px;
      transition: width var(--transition-slow);
    }

    /* Subtle text animations */
    .text-gradient {
      background: linear-gradient(135deg, var(--accent), var(--accent-secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Card hover lift effect */
    .card-lift {
      transition: transform var(--transition-base), box-shadow var(--transition-base);
    }

    .card-lift:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
    }

    /* Staggered animation for lists */
    .stagger-in>* {
      opacity: 0;
      transform: translateY(10px);
      animation: stagger-fade-in 0.3s ease forwards;
    }

    .stagger-in>*:nth-child(1) {
      animation-delay: 0ms;
    }

    .stagger-in>*:nth-child(2) {
      animation-delay: 50ms;
    }

    .stagger-in>*:nth-child(3) {
      animation-delay: 100ms;
    }

    .stagger-in>*:nth-child(4) {
      animation-delay: 150ms;
    }

    .stagger-in>*:nth-child(5) {
      animation-delay: 200ms;
    }

    .stagger-in>*:nth-child(n+6) {
      animation-delay: 250ms;
    }

    @keyframes stagger-fade-in {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Ripple effect for buttons */
    .ripple {
      position: relative;
      overflow: hidden;
    }

    .ripple::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: width 0.3s, height 0.3s;
    }

    .ripple:active::after {
      width: 200px;
      height: 200px;
    }

    /* Status Dot */
    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      display: inline-block;
    }

    .status-dot.online {
      background: var(--success);
    }

    .status-dot.offline {
      background: var(--text-muted);
    }

    .status-dot.warning {
      background: var(--warning);
    }

    .status-dot.error {
      background: var(--danger);
    }

    /* Animated status dot */
    .status-dot.pulse {
      animation: status-pulse 2s ease-in-out infinite;
    }

    @keyframes status-pulse {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: 0.5;
      }
    }

    /* Improved table styling */
    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
    }

    th,
    td {
      padding: 12px 16px;
      text-align: left;
      border-bottom: 1px solid var(--glass-border);
    }

    th {
      font-weight: 600;
      color: var(--text-secondary);
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      background: rgba(255, 255, 255, 0.02);
    }

    tr:hover td {
      background: rgba(255, 255, 255, 0.02);
    }

    /* Improved Select dropdown */
    select {
      appearance: none;
      -webkit-appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      padding-right: 36px !important;
      background-color: var(--card);
    }

    /* Ensure pantry filter has dropdown arrow */
    #pantryFilter,
    #collectionFilter,
    #shopStoreFilter {
      appearance: none !important;
      -webkit-appearance: none !important;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E") !important;
      background-repeat: no-repeat !important;
      background-position: right 12px center !important;
      padding-right: 36px !important;
      background-color: var(--card) !important;
    }

    /* Number input spinners */
    input[type="number"]::-webkit-inner-spin-button,
    input[type="number"]::-webkit-outer-spin-button {
      opacity: 0.5;
    }

    input[type="number"]:hover::-webkit-inner-spin-button,
    input[type="number"]:hover::-webkit-outer-spin-button {
      opacity: 1;
    }

    /* Improved link styling */
    a {
      color: var(--accent);
      text-decoration: none;
      transition: color var(--transition-fast);
    }

    a:hover {
      color: var(--accent-hover);
      text-decoration: underline;
    }

    /* Code/monospace styling */
    code,
    pre {
      font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 4px;
    }

    code {
      padding: 2px 6px;
      font-size: 0.9em;
    }

    pre {
      padding: 16px;
      overflow-x: auto;
    }

    /* Tag/Chip improvements */
    .tag {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 10px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--glass-border);
      border-radius: 16px;
      font-size: 12px;
      color: var(--text-secondary);
      transition: all var(--transition-fast);
    }

    .tag:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: var(--line-strong);
    }

    .tag-closable {
      cursor: pointer;
    }

    .tag-closable:hover {
      border-color: var(--danger);
      color: var(--danger);
    }

    /* Avatar */
    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent), var(--accent-secondary));
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      color: white;
      font-size: 14px;
    }

    .avatar-sm {
      width: 32px;
      height: 32px;
      font-size: 12px;
    }

    .avatar-lg {
      width: 56px;
      height: 56px;
      font-size: 18px;
    }

    /* Notification dot on icons */
    .has-notification {
      position: relative;
    }

    .has-notification::after {
      content: '';
      position: absolute;
      top: -2px;
      right: -2px;
      width: 8px;
      height: 8px;
      background: var(--danger);
      border-radius: 50%;
      border: 2px solid var(--bg);
    }

    /* Keyboard shortcut styling */
    kbd {
      display: inline-block;
      padding: 2px 6px;
      font-family: inherit;
      font-size: 11px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid var(--glass-border);
      border-radius: 4px;
      box-shadow: 0 1px 0 var(--glass-border);
    }

    /* Section headers */
    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .section-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Subtle glow effect */
    .glow {
      box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
    }

    .glow-accent {
      box-shadow: 0 0 30px rgba(16, 185, 129, 0.4);
    }

    /* Print styles */
    @media print {
      * {
        background: white !important;
        color: black !important;
        box-shadow: none !important;
      }

      .no-print {
        display: none !important;
      }
    }

    /* Fix for Shopping List & Generate Checkboxes - Custom Styled */
    .shopping-item-checkbox,
    #shopIncludeCollections,
    #shopIncludeLowStock,
    #shopCollectionAddToDateRange {
      appearance: none;
      -webkit-appearance: none;
      width: 24px !important;
      height: 24px !important;
      cursor: pointer;
      background-color: rgba(255, 255, 255, 0.05);
      /* Subtle dark mode bg */
      border: 2px solid var(--muted);
      border-radius: 6px;
      position: relative;
      margin: 0;
      transition: all 0.2s ease;
      vertical-align: middle;
      flex-shrink: 0;
    }

    .shopping-item-checkbox:hover,
    #shopIncludeCollections:hover,
    #shopIncludeLowStock:hover,
    #shopCollectionAddToDateRange:hover {
      border-color: var(--accent);
      background-color: rgba(77, 163, 255, 0.1);
    }

    .shopping-item-checkbox:checked,
    #shopIncludeCollections:checked,
    #shopIncludeLowStock:checked,
    #shopCollectionAddToDateRange:checked {
      background-color: var(--accent);
      border-color: var(--accent);
    }

    /* Custom thick checkmark */
    .shopping-item-checkbox:checked::after,
    #shopIncludeCollections:checked::after,
    #shopIncludeLowStock:checked::after,
    #shopCollectionAddToDateRange:checked::after {
      content: '';
      position: absolute;
      left: 7px;
      top: 3px;
      width: 6px;
      /* Fat checkmark */
      height: 12px;
      border: solid white;
      /* Always white check on accent background */
      border-width: 0 3px 3px 0;
      transform: rotate(45deg);
      display: block;
    }

    .shop-item-check {
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 32px;
    }